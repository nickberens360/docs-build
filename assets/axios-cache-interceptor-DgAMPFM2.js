import{o as R}from"./cache-parser-DXYp_BCq.js";import{e as W}from"./fast-defer-9MI9za_P.js";import{r as B}from"./object-code-SBtdq8jY.js";var y={d:(e,t)=>{for(var a in t)y.o(t,a)&&!y.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},f={};y.d(f,{h4:()=>l,UN:()=>q,uu:()=>F,Kd:()=>b,ZF:()=>z,nv:()=>S,p:()=>D,E7:()=>L,NQ:()=>k,xK:()=>H,G6:()=>J,LN:()=>K,Bw:()=>x,Ad:()=>C,$k:()=>U,v8:()=>Z,Jk:()=>P,tI:()=>X,iS:()=>M});const N=(e=>{var t={};return y.d(t,e),t})({parse:()=>R}),l=Object.freeze({IfModifiedSince:"if-modified-since",LastModified:"last-modified",IfNoneMatch:"if-none-match",CacheControl:"cache-control",Pragma:"pragma",ETag:"etag",Expires:"expires",Age:"age",XAxiosCacheEtag:"x-axios-cache-etag",XAxiosCacheLastModified:"x-axios-cache-last-modified",XAxiosCacheStaleIfError:"x-axios-cache-stale-if-error"}),k=e=>{if(!e)return"not enough headers";const t=e[l.CacheControl];if(t){const{noCache:s,noStore:r,maxAge:o,maxStale:i,immutable:n,staleWhileRevalidate:c}=(0,N.parse)(String(t));if(s||r)return"dont cache";if(n)return{cache:31536e6};if(o!==void 0){const h=e[l.Age];return{cache:h?1e3*(o-Number(h)):1e3*o,stale:i!==void 0?1e3*i:c!==void 0?1e3*c:void 0}}}const a=e[l.Expires];if(a){const s=Date.parse(String(a))-Date.now();return s>=0?{cache:s}:"dont cache"}return"not enough headers"},G=(e=>{var t={};return y.d(t,e),t})({deferred:()=>W});function L(e){return e?t=>e(t)||t===304:t=>t>=200&&t<300||t===304}function C(e="get",t=[]){return e=e.toLowerCase(),t.some(a=>a===e)}function M(e,t){var a;t.headers||(t.headers={});const{etag:s,modifiedSince:r}=t.cache;if(s){const o=s===!0?(a=e.data)===null||a===void 0?void 0:a.headers[l.ETag]:s;o&&(t.headers[l.IfNoneMatch]=o)}r&&(t.headers[l.IfModifiedSince]=r===!0?e.data.headers[l.LastModified]||new Date(e.createdAt).toUTCString():r.toUTCString())}function D(e,t){return e.status===304&&t?(e.cached=!0,e.data=t.data,e.status=t.status,e.statusText=t.statusText,e.headers=Object.assign(Object.assign({},t.headers),e.headers),t):{data:e.data,status:e.status,statusText:e.statusText,headers:e.headers}}function J(e){const t=async a=>{var s,r,o,i,n,c,h,d,v,m,p,g,A,E,O;if(a.id=e.generateKey(a),a.cache===!1||(a.cache=Object.assign(Object.assign({},e.defaults.cache),a.cache),a.cache.cacheTakeover&&((s=(m=a.headers)[p=l.CacheControl])!==null&&s!==void 0||(m[p]="no-cache"),(r=(g=a.headers)[A=l.Pragma])!==null&&r!==void 0||(g[A]="no-cache"),(o=(E=a.headers)[O=l.Expires])!==null&&o!==void 0||(E[O]="0")),!C(a.method,a.cache.methods)))return a;let u=await e.storage.get(a.id,a);const I=a.cache.override;e:if(u.state==="empty"||u.state==="stale"||I){if(e.waiting[a.id]&&!I&&(u=await e.storage.get(a.id,a),u.state!=="empty"))break e;return e.waiting[a.id]=(0,G.deferred)(),e.waiting[a.id].catch(()=>{}),await e.storage.set(a.id,{state:"loading",previous:I?u.data?"stale":"empty":u.state,data:u.data,createdAt:I&&!u.createdAt?Date.now():u.createdAt},a),u.state==="stale"&&M(u,a),a.validateStatus=L(a.validateStatus),(u.state==="stale"||u.data)&&await((n=(i=a.cache).hydrate)===null||n===void 0?void 0:n.call(i,u)),a}let w;if(u.state==="loading"){const T=e.waiting[a.id];if(!T)return u.data&&await((h=(c=a.cache).hydrate)===null||h===void 0?void 0:h.call(c,u)),a;try{w=await T}catch{return u.data&&await((v=(d=a.cache).hydrate)===null||v===void 0?void 0:v.call(d,u)),t(a)}}else w=u.data;return a.adapter=function(){return Promise.resolve({config:a,data:w.data,headers:w.headers,status:w.status,statusText:w.statusText,cached:!0,id:a.id})},a};return{onFulfilled:t,apply:()=>e.interceptors.request.use(t)}}async function P(e,t){var a;if(typeof t=="function")return t(e);const{statusCheck:s,responseMatch:r,containsHeaders:o}=t;if(s&&!await s(e.status)||r&&!await r(e))return!1;if(o){for(const[i,n]of Object.entries(o))if(!await n((a=e.headers[i.toLowerCase()])!==null&&a!==void 0?a:e.headers[i]))return!1}return!0}async function X(e,t,a){if(typeof a=="function")return a(t);for(const[s,r]of Object.entries(a)){if(r==="delete"){await e.remove(s,t.config);continue}const o=await e.get(s,t.config);if(o.state==="loading")continue;const i=await r(o,t);i!=="delete"?i!=="ignore"&&await e.set(s,i,t.config):await e.remove(s,t.config)}}function K(e){const t=async(r,o)=>{var i;await e.storage.remove(r,o),(i=e.waiting[r])===null||i===void 0||i.reject(),delete e.waiting[r]},a=async r=>{var o;if(!(r!=null&&r.config))throw r;r.id=r.config.id,(o=r.cached)!==null&&o!==void 0||(r.cached=!1);const i=r.config,n=i.cache;if(r.cached)return r;if(!n)return r.cached=!1,r;if(n.update&&await X(e.storage,r,n.update),!C(i.method,n.methods))return r;const c=await e.storage.get(r.id,i);if(c.state!=="loading")return r;if(!c.data&&!await P(r,n.cachePredicate))return await t(r.id,i),r;for(const g of Object.keys(r.headers))g.startsWith("x-axios-cache")&&delete r.headers[g];n.etag&&n.etag!==!0&&(r.headers[l.XAxiosCacheEtag]=n.etag),n.modifiedSince&&(r.headers[l.XAxiosCacheLastModified]=n.modifiedSince===!0?"use-cache-timestamp":n.modifiedSince.toUTCString());let h,d=n.ttl||-1;if(n.interpretHeader){const g=e.headerInterpreter(r.headers);if(g==="dont cache")return await t(r.id,i),r;g!=="not enough headers"&&(typeof g=="number"?d=g:(d=g.cache,h=g.stale))}const v=D(r,c.data);typeof d=="function"&&(d=await d(r)),n.staleIfError&&(r.headers[l.XAxiosCacheStaleIfError]=String(d));const m={state:"cached",ttl:d,staleTtl:h,createdAt:Date.now(),data:v},p=e.waiting[r.id];return p&&(p.resolve(m.data),delete e.waiting[r.id]),await e.storage.set(r.id,m,i),r},s=async r=>{var o;if(!r.isAxiosError)throw r;const i=r.config,n=i.id,c=i.cache,h=r.response;if(!c||!n||!C(i.method,c.methods))throw r;const d=await e.storage.get(n,i);if(d.state!=="loading"||d.previous!=="stale")throw await t(n,i),r;if(c.staleIfError){const v=String(h==null?void 0:h.headers[l.CacheControl]),m=v&&(0,N.parse)(v).staleIfError,p=typeof c.staleIfError=="function"?await c.staleIfError(h,d,r):c.staleIfError===!0&&m?1e3*m:c.staleIfError;if(p===!0||typeof p=="number"&&d.createdAt+p>Date.now())return(o=e.waiting[n])===null||o===void 0||o.resolve(d.data),delete e.waiting[n],await e.storage.set(n,{state:"stale",createdAt:Date.now(),data:d.data},i),{cached:!0,config:i,id:n,data:d.data.data,headers:d.data.headers,status:d.data.status,statusText:d.data.statusText}}throw r};return{onFulfilled:a,onRejected:s,apply:()=>e.interceptors.response.use(a,s)}}const U=e=>!!e&&!!e["is-storage"];function $(e){const t=e.data.headers;return l.ETag in t||l.LastModified in t||l.XAxiosCacheEtag in t||l.XAxiosCacheLastModified in t}function S(e){return!String(e.data.headers[l.CacheControl]).includes("must-revalidate")&&(!!$(e)||e.state==="cached"&&e.staleTtl!==void 0&&Math.abs(Date.now()-(e.createdAt+e.ttl))<=e.staleTtl)}function x(e){return e.ttl!==void 0&&e.createdAt+e.ttl<=Date.now()}function b({set:e,find:t,remove:a}){return{"is-storage":1,set:e,remove:a,get:async(s,r)=>{let o=await t(s,r);if(!o)return{state:"empty"};if(o.state==="empty"||o.state==="loading")return o;if(o.state==="cached"){if(!x(o))return o;if(!S(o))return await a(s,r),{state:"empty"};o={state:"stale",createdAt:o.createdAt,data:o.data,ttl:o.staleTtl!==void 0?o.staleTtl+o.ttl:void 0},await e(s,o,r)}return x(o)?$(o)?o:(await a(s,r),{state:"empty"}):o}}}function F(e=!1,t=!1,a=!1){const s=b({set:(r,o)=>{if(a){let i=Object.keys(s.data);if(i.length>=a)for(s.cleanup(),i=Object.keys(s.data);i.length>=a;)delete s.data[i.shift()]}s.data[r]=e==="double"?typeof structuredClone=="function"?structuredClone(o):JSON.parse(JSON.stringify(o)):o},remove:r=>{delete s.data[r]},find:r=>{const o=s.data[r];return e&&o!==void 0?typeof structuredClone=="function"?structuredClone(o):JSON.parse(JSON.stringify(o)):o}});return s.data=Object.create(null),s.cleanup=()=>{const r=Object.keys(s.data);let o,i,n=-1;for(;++n<r.length;)i=r[n],o=s.data[i],o.state!=="empty"?o.state==="cached"&&x(o)&&!S(o)&&s.remove(i):s.remove(i)},t&&(s.cleaner=setInterval(s.cleanup,t)),s}const Q=(e=>{var t={};return y.d(t,e),t})({hash:()=>B}),j=/^\/|\/$/g;function q(e){return t=>{if(t.id)return t.id;const a=e(t);return typeof a=="string"||typeof a=="number"?`${a}`:`${(0,Q.hash)(a)}`}}const H=q(({baseURL:e="",url:t="",method:a="get",params:s,data:r})=>(e&&(e=e.replace(j,"")),t&&(t=t.replace(j,"")),a&&(a=a.toLowerCase()),{url:e+(e&&t?"/":"")+t,params:s,method:a,data:r}));function Z(e,t={}){var a,s,r,o,i,n;const c=e;if(c.defaults.cache)throw new Error("setupCache() should be called only once");if(c.storage=t.storage||F(),!U(c.storage))throw new Error("Use buildStorage() function");return c.waiting=t.waiting||{},c.generateKey=t.generateKey||H,c.headerInterpreter=t.headerInterpreter||k,c.requestInterceptor=t.requestInterceptor||J(c),c.responseInterceptor=t.responseInterceptor||K(c),c.debug=t.debug,c.defaults.cache={update:t.update||{},ttl:(a=t.ttl)!==null&&a!==void 0?a:3e5,methods:t.methods||["get","head"],cachePredicate:t.cachePredicate||{statusCheck:h=>[200,203,300,301,302,404,405,410,414,501].includes(h)},etag:(s=t.etag)===null||s===void 0||s,modifiedSince:(r=t.modifiedSince)!==null&&r!==void 0?r:t.etag===!1,interpretHeader:(o=t.interpretHeader)===null||o===void 0||o,cacheTakeover:(i=t.cacheTakeover)===null||i===void 0||i,staleIfError:(n=t.staleIfError)===null||n===void 0||n,override:!1,hydrate:void 0},c.requestInterceptor.apply(),c.responseInterceptor.apply(),c}function z(e,t="axios-cache-"){return b({find:a=>{const s=e.getItem(t+a);return s?JSON.parse(s):void 0},remove:a=>{e.removeItem(t+a)},set:(a,s)=>{const r=()=>e.setItem(t+a,JSON.stringify(s));try{return r()}catch{const i=Object.entries(e).filter(n=>n[0].startsWith(t)).map(n=>[n[0],JSON.parse(n[1])]);for(const n of i)n[1].state==="cached"&&x(n[1])&&!S(n[1])&&e.removeItem(n[0]);try{return r()}catch{const c=i.sort((h,d)=>(h[1].createdAt||0)-(d[1].createdAt||0));for(const h of c){e.removeItem(h[0]);try{return r()}catch{}}}e.removeItem(t+a)}}})}f.h4;f.UN;f.uu;f.Kd;f.ZF;f.nv;f.p;f.E7;f.NQ;f.xK;f.G6;f.LN;f.Bw;f.Ad;f.$k;var te=f.v8;f.Jk;f.tI;f.iS;export{te as F};
