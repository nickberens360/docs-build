import{m as j,c as O}from"./vuex.0eb68a2c.js";import E from"./S3Image.32e445d0.js";import{S as U,e as r,x as c,k as e,g as a,L as D,M as I,s as N,F as h,J as d,I as v,f as _,j as P,G as S,B as H,z,E as k,aj as Q,ak as Y}from"./@vue.ee679632.js";import{_ as Z}from"./index.8a58b007.js";import{d as G,c as F,r as J,q as C,k as W,Z as X,t as K,x as b,w as y,_ as A,$ as ee,a0 as te,a1 as ae,p as R,D as oe,a2 as se,i as le,a3 as ie,s as ne,a4 as B,O as re}from"./vuetify.65d833ec.js";import"./date-fns.d38e1d55.js";import"./vue-atomic-docs.4f3653eb.js";import"./vue-router.ec64e966.js";import"./axios.eca6faa7.js";import"./axios-cache-interceptor.0956cad0.js";import"./cache-parser.124ebbb8.js";import"./fast-defer.b34f24de.js";import"./object-code.c2755e43.js";import"./@fortawesome.2cecc5e3.js";import"./@awesome.me.7dae7d79.js";const $=26214400,de={components:{S3Image:E},props:{loading:Boolean,show:Boolean,selectedCategory:{type:Object,default:()=>({})},exampleImagePrefix:{type:String,default:""}},emits:["upload"],data:()=>({queuedFiles:[],previewURLs:[],dragOver:!1,previewLoading:!1,previewPercent:0,oversizedUpload:!1}),computed:{...j("app",["uploadModal"]),livePreviewPercent(){return this.previewPercent}},methods:{...O("app",["setUploadModal"]),onUpload(){this.$emit("upload",{files:this.queuedFiles,blobs:this.previewURLs}),this.closeUploadProcess()},onFilesChosen(t){!t.length||(this.previewPercent=0,this.previewLoading=!0,this.downscaleQueuedImages(t).then(s=>{this.previewURLs=s.map(l=>URL.createObjectURL(l)),this.queuedFiles=Array.from(s),this.previewLoading=!1,this.$refs.upload.value=null}).catch(s=>{switch(this.previewLoading=!1,s){case"oversize":this.$refs.upload.value=null;break}}))},downscaleQueuedImages(t){return new Promise((s,l)=>{let m=[],i=0;const w=u=>{m.push(u),i+=u.size,this.previewPercent=m.length*170/t.length,m.length===t.length&&(this.oversizedUpload=i>$,this.oversizedUpload?(console.warn(`Total file size not within payload limit: ${i}/${$}`),l("oversize")):console.log("files compressed, within payload size limits"),s(m))};for(const u of t){const f=new FileReader;f.onerror=g=>console.error(g),f.onload=g=>{const o=new Image;o.onload=()=>{if(o.width>=1080||o.height>=1080){let n,p;o.width>=o.height?(n=1080,p=o.height*n/o.width):(p=1080,n=o.width*p/o.height);const V=document.createElement("canvas");V.width=n,V.height=p;const L=V.getContext("2d");L.drawImage(o,0,0,n,p),L.canvas.toBlob(T=>{const M=new File([T],u.name,{type:u.type});w(M)},u.type,1)}else w(u)},o.src=g.target.result},f.readAsDataURL(u)}})},chooseFile(){this.setUploadModal(!0)},closeUploadProcess(){this.setUploadModal(!1),this.queuedFiles=[],this.previewURLs=[],this.oversizedUpload=!1},openSystemDialog(){this.$refs.upload.click()}}},x=t=>(Q("data-v-7ae0eff6"),t=t(),Y(),t),ue={class:"font-weight-bold text-primary subtitle text-center"},pe={key:0},ce={key:1},me=x(()=>k("br",null,null,-1)),fe=x(()=>k("span",null,"Add Photo",-1));function ge(t,s,l,q,m,i){const w=U("S3Image"),u=U("VBtnSecondary"),f=U("VBtnPrimary");return r(),c(ne,{location:"start"},{activator:e(({props:g})=>[a(ie,null,{default:e(()=>[D(a(G,N({loading:l.loading,color:"secondary"},g,{icon:"",position:"fixed",size:"large",style:t.$vuetify.display.smAndDown?"bottom: 80px":"",location:"bottom end",onClick:h(i.chooseFile,["stop"])}),{default:e(()=>[a(F,null,{default:e(()=>[d("$vuetify.icons.camera")]),_:1}),a(J,{modelValue:t.uploadModal,"onUpdate:modelValue":s[4]||(s[4]=o=>t.uploadModal=o),"max-width":800,fullscreen:t.$vuetify.display.smAndDown,"onClick:outside":i.closeUploadProcess},{default:e(()=>[a(C,null,{default:e(()=>[a(W,null,{default:e(()=>[d("Upload "+v(l.selectedCategory.name)+" Image",1)]),_:1}),a(X,{class:"mt-1 text-subtitle-2"},{default:e(()=>[d(v(l.selectedCategory.desc),1)]),_:1}),a(K,{class:"pb-0"},{default:e(()=>[a(b,{align:"stretch"},{default:e(()=>[a(y,{cols:"12",sm:"6"},{default:e(()=>[a(C,{flat:""},{default:e(()=>[a(A,{cycle:"",interval:"5000","show-arrows":l.selectedCategory.qty>1,"hide-delimiters":"",height:"100%","next-icon":"$vuetify.icons.angleRight","prev-icon":"$vuetify.icons.angleLeft"},{default:e(()=>[(r(!0),_(S,null,P(l.selectedCategory.qty,o=>(r(),c(B,{key:o},{default:e(()=>[a(w,{bucket:"minutekey-kiosk-images","object-key":`samples/${l.selectedCategory.code}${o}.jpg`,"lazy-key":"samples/loadingimage.png","aspect-ratio":t.$vuetify.display.smAndDown?void 0:3/4},null,8,["object-key","aspect-ratio"])]),_:2},1024))),128))]),_:1},8,["show-arrows"])]),_:1})]),_:1}),a(y,{cols:"12",sm:"6"},{default:e(()=>[a(ee,null,{default:e(({hover:o})=>[a(te,{"aspect-ratio":t.$vuetify.display.smAndDown?4/3:3/4},{default:e(()=>[a(C,{ripple:t.previewURLs.length===0,link:"",flat:"",class:H(`droppable-area bg-primary-lighten-${o||t.dragOver?4:5}`),onDrop:s[1]||(s[1]=h(n=>i.onFilesChosen(n.dataTransfer.files),["prevent"])),onDragleave:s[2]||(s[2]=h(n=>t.dragOver=!1,["prevent"])),onDragover:s[3]||(s[3]=h(n=>t.dragOver=!0,["prevent"])),onClick:i.openSystemDialog},{default:e(()=>[t.previewLoading?(r(),c(ae,{key:0,height:25,absolute:"",location:"top",color:"secondary","model-value":i.livePreviewPercent},null,8,["model-value"])):z("",!0),t.previewURLs.length?(r(),c(C,{key:1,flat:"",height:"100%"},{default:e(()=>[a(A,{"show-arrows":t.queuedFiles.length>1,"hide-delimiters":"",height:"100%","next-icon":"$vuetify.icons.angleRight","prev-icon":"$vuetify.icons.angleLeft",onClick:s[0]||(s[0]=h(()=>{},["stop"]))},{default:e(()=>[(r(!0),_(S,null,P(t.previewURLs,(n,p)=>(r(),c(B,{key:p},{default:e(()=>[a(re,{"aspect-ratio":t.$vuetify.display.smAndDown?void 0:3/4,src:n},null,8,["aspect-ratio","src"])]),_:2},1024))),128))]),_:1},8,["show-arrows"])]),_:1})):(r(),c(b,{key:2,align:"center",class:"fill-height"},{default:e(()=>[a(y,null,{default:e(()=>[k("div",ue,[a(F,{class:"mx-auto mb-4",size:"x-large"},{default:e(()=>[d(" $vuetify.icons.image ")]),_:1}),t.$vuetify.display.smAndDown?(r(),_("div",pe," Tap to Upload ")):(r(),_("div",ce,[d(" Drop your image here "),me,d(" or click to upload ")]))])]),_:1})]),_:1}))]),_:2},1032,["ripple","class","onClick"])]),_:2},1032,["aspect-ratio"])]),_:1})]),_:1})]),_:1}),t.$vuetify.display.smAndDown?z("",!0):(r(),c(b,{key:0,class:"font-weight-bold text-center"},{default:e(()=>[a(y,{cols:"6"},{default:e(()=>[d(" Example "+v(l.selectedCategory.name)+" Image"+v(l.selectedCategory.qty>1?"s":""),1)]),_:1}),a(y,{cols:"6"},{default:e(()=>[d(" Your Image"+v(t.queuedFiles.length>1?"s":""),1)]),_:1})]),_:1}))]),_:1}),a(R,null,{default:e(()=>[a(oe,null,{default:e(()=>[D(a(se,{icon:"$vuetify.icons.exclamationTriangle",class:"mx-4 mb-0",variant:"outlined",width:"100%",type:"error"},{default:e(()=>[d(" Total file size is too large. Please try again with less images. ")]),_:1},512),[[I,t.oversizedUpload]])]),_:1})]),_:1}),a(R,null,{default:e(()=>[a(le),a(u,{onClick:i.closeUploadProcess},{default:e(()=>[d(" Cancel ")]),_:1},8,["onClick"]),a(f,{class:"mr-4",disabled:!t.queuedFiles.length||t.oversizedUpload,onClick:i.onUpload},{default:e(()=>[d(" Upload ")]),_:1},8,["disabled","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen","onClick:outside"])]),_:2},1040,["loading","style","onClick"]),[[I,l.show]])]),_:2},1024),k("input",{ref:"upload",class:"hidden",accept:".jpg,.jpg,.png",type:"file",multiple:"",onChange:s[5]||(s[5]=o=>i.onFilesChosen(o.target.files))},null,544)]),default:e(()=>[fe]),_:1})}const ze=Z(de,[["render",ge],["__scopeId","data-v-7ae0eff6"]]);export{ze as default};
