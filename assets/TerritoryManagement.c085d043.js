import{m as M,a as W,b as Y}from"./vuex.0eb68a2c.js";import{_ as q,v as N,T as J}from"./index.8a58b007.js";import Q from"./MeruDataTable.80a372ee.js";import X from"./DefaultLayout.61d229e4.js";import{S as x,e as d,x as h,k as t,g as a,J as u,I as m,L as Z,M as $,E as T,f,j as D,G as U,z as b,B as ee,s as re,m as te,p as ie,aj as se,ak as le}from"./@vue.ee679632.js";import{a2 as ae,a6 as ne,w as g,T as oe,d as _,x as v,c as E,ax as de,q as A,k as R,t as B,l as ue,aj as H,u as L,ad as w,p as G,r as O,i as me,v as S,V as P,e as K,s as z,f as j,U as pe}from"./vuetify.65d833ec.js";import"./date-fns.d38e1d55.js";import"./vue-atomic-docs.4f3653eb.js";import"./vue-router.ec64e966.js";import"./axios.eca6faa7.js";import"./axios-cache-interceptor.0956cad0.js";import"./cache-parser.124ebbb8.js";import"./fast-defer.b34f24de.js";import"./object-code.c2755e43.js";import"./@fortawesome.2cecc5e3.js";import"./@awesome.me.7dae7d79.js";const ye={components:{MeruDataTable:Q,DefaultLayout:X},data(){return{apiErrorLog:"",dialogTerritory:!1,valid:!1,search:null,baseTerritoryHeaders:[{sortable:!0,groupable:!1,align:"start",title:"Name",key:"name"},{sortable:!0,groupable:!0,align:"right",title:"Primary KT",key:"primaryUser"},{sortable:!0,groupable:!0,align:"right",title:"Secondary KT",key:"secondaryUser"}],homeHeaders:[{sortable:!0,groupable:!0,title:"Type",key:"territoryTypeName"},{sortable:!0,groupable:!0,title:"Business Group",key:"Business Group.name"},{sortable:!0,groupable:!0,title:"Market/Region",key:"Market/Region.name"},{sortable:!0,groupable:!0,title:"District",key:"District.name"}],rdsHeaders:[{sortable:!0,groupable:!0,title:"Market",key:"market.name"}],salesServiceHeaders:[{sortable:!0,groupable:!0,title:"Region",key:"region.name"},{sortable:!0,groupable:!0,title:"District",key:"district.name"}],siteHeaders:[{sortable:!0,title:"Code",key:"location.code"},{sortable:!0,title:"Location",key:"location.name"},{sortable:!0,title:"Placement",key:"placement"},{sortable:!0,title:"Kiosk",key:"kiosk.serialNumber"},{sortable:!0,title:"Grade",key:"grade"}],selectedTab:"Home",currentEditItem:null,territoryInputValid:!1,inputTerritory:{name:"",territoryType:"Field",group:void 0,market:void 0,region:void 0,district:void 0,primaryUser:"",secondaryUser:""},groups:{RDS:{territoryTypes:["Field","Market"]},default:{territoryTypes:["Field","District","Region"]}},isShowEveryone:!0,expanded:[],expandedModel:[],deleteDialog:!1,currentItemToDelete:null,addOrEditRules:[r=>!!r||"Required",()=>!this.existingInputTerritory||this.sameTerritory(this.currentEditItem,this.existingInputTerritory)||`${this.inputTerritory.name} under ${this.inputParentTypes[0]} ${this.inputParent.name} already exists!`,r=>this.inputTerritory.territoryType[0]!=="F"||!this.inputGroup||this.inputGroup.name==="RDS"||!!String(r).match(/^[0-9]{3}$/)||"Name must be a 3 digit number from 001-999!"],fieldSites:{},allAvailableTabs:["Home","RDS","Field Sales","Field Service"],isChangingTab:!1}},computed:{...M("territories",["userTerritories","loadingUserTerritories","loadingAllTerritories","allTerritories","territoryUsers","loadingUsers","apiError"]),...M("user",["permissions"]),...W("territories",["flatAllTerritories","flatUserTerritories"]),allTerritoryUsers(){return{...this.territoryUsers.fieldUsers,...this.territoryUsers.managers}},allTerritoriesToShow(){return this.isShowEveryone?this.allTerritories:this.userTerritories},flatTerritoriesToShow(){return this.isShowEveryone?this.flatAllTerritories:this.flatUserTerritories},territoryItems(){var r=[];if(this.selectedTab==="RDS"){const e=this.allTerritoriesToShow.find(i=>i.name==="RDS");r=(e?e.children:[]).flatMap(i=>i.children.map(l=>({...l,market:{name:i.name,id:i.id}})))}else if(this.selectedTab==="Home")r=this.flatTerritoriesToShow;else{const e=this.allTerritoriesToShow.find(i=>i.name===this.selectedTab);r=(e?e.children:[]).flatMap(i=>i.children.flatMap(l=>l.children.map(c=>({...c,region:{name:i.name,id:i.id},district:{name:l.name,id:l.id}}))))}return r.map(e=>{const{primaryUser:n,secondaryUser:o}=e;return{...e,primaryUser:n||"",secondaryUser:o||"",territoryTypeName:N(e)}})},territoryHeaders(){const[r,e,n]=this.baseTerritoryHeaders;switch(this.selectedTab){case"Home":return[r,...this.homeHeaders,e,n];case"RDS":return[r,...this.rdsHeaders,e,n];case"Field Sales":case"Field Service":return[r,...this.salesServiceHeaders,e,n];default:return[]}},loading(){return this.isShowEveryone?this.loadingAllTerritories||this.loadingUsers:this.loadingUserTerritories||this.loadingUsers},tabs(){return["Home",...this.allAvailableTabs.filter(e=>this.allTerritoriesToShow.find(({name:n})=>n===e))]},userCanAdministerTerritories(){return this.permissions.indexOf("AdministerTerritories")>=0},userCanManageLocations(){return this.permissions.indexOf("ManageLocations")},userCanViewKiosks(){return this.permissions.indexOf("ViewKiosks")},existingInputTerritory(){return this.flatAllTerritories.find(r=>this.sameTerritory(r,this.normalizedInput))},userOptions(){var n;const r=((n=this.inputTerritory)==null?void 0:n.territoryType)==="Field"?"fieldUsers":"managers",e=this.territoryUsers[r]||{};return Object.keys(e).sort((o,i)=>{const l=`${e[o].lastName},${e[o].firstName}.${e[o].email}`,c=`${e[i].lastName},${e[i].firstName}.${e[i].email}`;return l<c?-1:l>c?1:0}).map(o=>({...e[o],username:o,identifier:`${this.fullnameFor(o)} (${e[o].email})`}))},inputTerritoryTypes(){const r=this.allTerritories.find(e=>this.inputTerritory.group===e.id);return r?(this.groups[r&&r.name]||this.groups.default).territoryTypes:[]},inputParentTypes(){const r=this.inputTerritoryTypes.indexOf(this.inputTerritory.territoryType);return r>=0?this.inputTerritoryTypes.slice(r+1):[]},inputParent(){const r=this.inputParentTypes[0];if(r)return this.flatAllTerritories.find(e=>e.id===this.inputTerritory[r.toLowerCase()])},inputGroup(){return this.allTerritories.find(r=>this.inputTerritory.group===r.id)},normalizedInput(){return this.inputTerritory&&{name:this.inputTerritory.name,parentId:this.inputTerritory.parentId,primaryUser:this.inputTerritory.primaryUser,secondaryUser:this.inputTerritory.secondaryUser}},isEditing(){return this.currentEditItem!==null},businessGroupColumnName(){return"item.Business Group.name"},marketSlashRegionColumnName(){return"item.Market/Region.name"},addOrEditTitle(){return this.isEditing?`Editing Territory - ${this.currentEditItem.name||""}`:"Add Territory"},isFieldTerritoryType(){return this.inputTerritory.territoryType[0]==="F"},territoryBusinessGroups(){return this.allTerritories.map(({id:r,name:e})=>({title:e,value:r}))},parentTerritories(){return[...this.inputParentTypes].reverse().map(e=>({type:e,items:this.territoriesOfType(e).map(n=>({title:n.name,value:n.id}))}))},availableTerritories(){let r={};return this.expandedModel.forEach(e=>{const n=this.territoryWithId(e);r[e]=this.flatAllTerritories.filter(({parentId:o})=>o===n.id)}),r}},watch:{apiError(){this.apiErrorLog+=this.apiError+`
`},async inputParent(){this.$refs.nameInput&&await this.$refs.nameInput.validate()},selectedTab(){this.isChangingTab=!0,setTimeout(()=>{this.isChangingTab=!1},1e3)}},mounted(){this.userCanAdministerTerritories&&this.loadAllTerritories()},beforeMount(){this.loadUserTerritories(),this.loadTerritoryUsers()},methods:{...Y("territories",["loadUserTerritories","loadAllTerritories","loadTerritoryUsers","updateTerritory","deleteTerritory"]),territoryTypeName:N,setTerritoryParentId(r){let e=this.territoryWithId(r);this.inputTerritory.parentId=(e==null?void 0:e.id)||void 0,(e==null?void 0:e.territoryType)==="D"&&(this.inputTerritory.region=e.parentId)},territoryWithId(r){return this.flatAllTerritories.find(e=>e.id===r)},setActiveRow(r){if(this.expandedModel.includes(r.id)){this.expandedModel=this.expandedModel.filter(e=>e!==r.id),this.expanded=this.expanded.filter(e=>e.id!==r.id);return}this.expandedModel.push(r.id),this.expanded.push(r),r.territoryType==="F"&&this.getTerritorySites(r)},sameTerritory(r,e){if(!r||!e)return!1;let n=(r.name||"").trim()===(e.name||"").trim(),o=r.parentId===e.parentId||!r.parentId&&!e.parentId;return n&&o},personFor(r){return this.allTerritoryUsers[r]||{firstName:r?`[username:${r}]`:"",lastName:""}},fullnameFor(r){const e=this.personFor(r);return`${e.firstName} ${e.lastName}`},territoryFilter(r,e,n){return e?r?e.indexOf(":")>=0?e.split(";").every(o=>{const[i,l]=o.split(":"),c=l.trim();if(["Market","Region"].includes(i)&&n.raw["Market/Region"])return n.raw["Market/Region"].name.toString()===c;if(this.selectedTab!=="Home"&&i==="Business Group")return this.selectedTab.toLowerCase()===c.toLowerCase();const V=this.territoryHeaders.filter(({title:I})=>I===i).map(({key:I})=>I)[0],C=V?n.columns[V]:n.columns[i];return C?C.toString().trim()===c:c==="[None]"}):Object.entries(n.columns).some(([o,i])=>{let c=["primaryUser","secondaryUser"].includes(o)?this.fullnameFor(i):i;return c==null?void 0:c.toLowerCase().includes(e.toString().toLowerCase())}):e==="[None]":!0},startAddFieldTerritory(){this.dialogTerritory=!0,this.inputTerritory.territoryType="Field"},territoriesOfType(r){return this.flatAllTerritories.filter(e=>e.territoryType[0]===r[0]&&e["Business Group"].id===this.inputGroup.id)},async onSaveInputTerritory(){var e,n;const{valid:r}=await this.$refs.addOrEditForm.validate();r&&(this.updateTerritory({id:(e=this.currentEditItem)==null?void 0:e.id,territoryUpdate:this.normalizedInput,isField:((n=this.currentEditItem)==null?void 0:n.territoryType)==="F"}),this.currentEditItem&&(this.expandedModel=this.expandedModel.filter(o=>o!==this.currentEditItem.id)),this.currentEditItem=null,this.$refs.addOrEditForm.reset(),this.dialogTerritory=!1)},openEditOn(r){var n,o,i;const e=this.territoryWithId(r);this.currentEditItem=e,this.dialogTerritory=!0,this.inputTerritory.name=e.name,this.inputTerritory.territoryType=this.territoryTypeName(e),this.inputTerritory.group=e["Business Group"].id,e.District?this.inputTerritory.district=(n=e.District)==null?void 0:n.id:this.inputTerritory.district=void 0,e["Business Group"].name==="RDS"?(this.inputTerritory.market=(o=e["Market/Region"])==null?void 0:o.id,this.inputTerritory.region=void 0):(this.inputTerritory.market=void 0,this.inputTerritory.region=(i=e["Market/Region"])==null?void 0:i.id),this.inputTerritory.primaryUser=e.primaryUser,this.inputTerritory.secondaryUser=e.secondaryUser,this.inputTerritory.parentId=e.parentId},childTerritoryType({name:r,territoryType:e,"Business Group":n}){if(e[0]==="G")return(this.groups[r]||this.groups.default).territoryTypes.at(-1);{const o=(this.groups[n&&n.name]||this.groups.default).territoryTypes;return o[o.map(i=>i[0]).indexOf(e)-1]}},canBeDeleted(r){var e,n;return!((n=(e=this.fieldSites[r.id])==null?void 0:e.sites)!=null&&n.length)},onClickDelete(r){this.deleteDialog=!0,this.currentItemToDelete=r},resetTable(){this.selectedTab="Home",this.search="",this.expandedModel=[]},removeTerritory(){this.currentItemToDelete&&(this.deleteTerritory(this.currentItemToDelete),this.deleteDialog=!1)},handleSearch(r,e="rowChip"){const n=this.territoryWithId(r),o=this.territoryWithId(n.parentId),i=e==="rowChip";if(!o)this.search=`Business Group:${n.name}`,this.selectedTab="Home";else{let l=this.childTerritoryType(o),V=`${l==="Field"||i?"Name":l}:${n.name.trim()}`,C=`${this.territoryTypeName(o)}:${o.name}`;this.search=`${V};${C}`,this.selectedTab=i?"Home":n["Business Group"].name}this.setActiveRow(n)},async getTerritorySites(r){this.fieldSites[r.id]={isLoadingSites:!0,apiError:""};try{let e=await J.getTerritoryData(r);this.fieldSites[r.id].sites=e.data.sites}catch{this.fieldSites[r.id].apiError="There was an error loading the data, please try again."}this.fieldSites[r.id].isLoadingSites=!1},cancelTerritorySave(){this.dialogTerritory=!1,this.currentEditItem=null},cancelRemoveTerritory(){this.deleteDialog=!1,this.currentItemToDelete=null}}},F=r=>(se("data-v-f7b71f14"),r=r(),le(),r),ce={key:1},he={key:1},fe={key:0,class:"on-surface-low-contrast-text"},Te={key:1},ge={key:2,class:"on-surface-low-contrast-text"},ke=["colspan"],be=F(()=>T("h4",null,"Actions",-1)),_e=F(()=>T("span",null,"Edit",-1)),ve=F(()=>T("h3",{class:"pl-1"}," Sites ",-1)),Ce=["href"],Se={key:1},Ve=["href"],Ie={key:1},xe=["href"],Ue={key:1},we={key:0},De={key:1};function Ee(r,e,n,o,i,l){const c=x("VBtnPrimary"),V=x("VBtnSecondary"),C=x("MeruDataTable"),I=x("DefaultLayout");return d(),h(I,null,{default:t(()=>[a(ne,null,{default:t(()=>[a(ae,{"model-value":!!i.apiErrorLog,closable:"",icon:"$vuetify.icons.exclamationTriangle",type:"error"},{default:t(()=>[u(m(i.apiErrorLog),1)]),_:1},8,["model-value"])]),_:1}),Z(T("div",null,[a(v,{dense:""},{default:t(()=>[a(g,{cols:"11",justify:"center"},{default:t(()=>[a(oe,{modelValue:i.selectedTab,"onUpdate:modelValue":e[0]||(e[0]=s=>i.selectedTab=s),"show-arrows":""},{default:t(()=>[(d(!0),f(U,null,D(l.tabs,s=>(d(),h(pe,{key:s,value:s},{default:t(()=>[s==="Home"?(d(),h(E,{key:0},{default:t(()=>[u(" $vuetify.icons.solidHome ")]),_:1})):(d(),f("span",ce,m(s),1))]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(g,{cols:"1",class:"d-flex justify-center align-center"},{default:t(()=>[a(_,{icon:"$vuetify.icons.undo",variant:"text",onClick:l.resetTable},null,8,["onClick"])]),_:1})]),_:1}),l.userCanAdministerTerritories?(d(),h(v,{key:0},{default:t(()=>[a(g,{cols:"6"},{default:t(()=>[a(c,{icon:r.$vuetify.display.xs,onClick:l.startAddFieldTerritory},{default:t(()=>[r.$vuetify.display.xs?(d(),h(E,{key:0},{default:t(()=>[u(" $vuetify.icons.plus ")]),_:1})):(d(),f("span",he,"Add Field Territory"))]),_:1},8,["icon","onClick"])]),_:1}),l.userCanAdministerTerritories?(d(),h(g,{key:0,cols:"6",align:"right"},{default:t(()=>[l.userCanAdministerTerritories?(d(),h(de,{key:0,modelValue:i.isShowEveryone,"onUpdate:modelValue":e[1]||(e[1]=s=>i.isShowEveryone=s),mandatory:"force",divided:"",color:"surface-light",border:""},{default:t(()=>[a(_,{value:!1},{default:t(()=>[u(" Me ")]),_:1}),a(_,{value:!0},{default:t(()=>[u(" Everyone ")]),_:1})]),_:1},8,["modelValue"])):b("",!0)]),_:1})):b("",!0)]),_:1})):b("",!0)],512),[[$,!r.loadingUserTerritories]]),a(O,{modelValue:i.dialogTerritory,"onUpdate:modelValue":e[7]||(e[7]=s=>i.dialogTerritory=s),"max-width":"800px"},{default:t(()=>[a(A,null,{default:t(()=>[a(R,null,{default:t(()=>[u(m(l.addOrEditTitle),1)]),_:1}),a(B,null,{default:t(()=>[a(ue,{ref:"addOrEditForm",modelValue:i.territoryInputValid,"onUpdate:modelValue":e[6]||(e[6]=s=>i.territoryInputValid=s)},{default:t(()=>[a(H,null,{default:t(()=>[a(v,null,{default:t(()=>[a(g,null,{default:t(()=>[a(L,{ref:"nameInput",modelValue:i.inputTerritory.name,"onUpdate:modelValue":e[2]||(e[2]=s=>i.inputTerritory.name=s),label:"Territory Name",disabled:!l.isFieldTerritoryType,rules:i.addOrEditRules,variant:"underlined"},null,8,["modelValue","disabled","rules"])]),_:1})]),_:1}),a(v,null,{default:t(()=>[a(g,{cols:"6"},{default:t(()=>[a(w,{modelValue:i.inputTerritory.primaryUser,"onUpdate:modelValue":e[3]||(e[3]=s=>i.inputTerritory.primaryUser=s),rules:[s=>!!s||"Required"],label:"Primary KT",items:l.userOptions,"item-title":"identifier","item-value":"username",class:"kt-autocomplete-input","menu-props":{width:"500"}},null,8,["modelValue","rules","items"])]),_:1}),a(g,{cols:"6"},{default:t(()=>[a(w,{modelValue:i.inputTerritory.secondaryUser,"onUpdate:modelValue":e[4]||(e[4]=s=>i.inputTerritory.secondaryUser=s),label:"Secondary KT",items:l.userOptions,"item-title":"identifier","item-value":"username",clearable:"",class:"kt-autocomplete-input","menu-props":{width:"500"}},null,8,["modelValue","items"])]),_:1}),l.isFieldTerritoryType?(d(),h(g,{key:0,cols:"6"},{default:t(()=>[a(w,{modelValue:i.inputTerritory.group,"onUpdate:modelValue":e[5]||(e[5]=s=>i.inputTerritory.group=s),label:"Business Group",rules:[s=>!!s||"Required"],items:l.territoryBusinessGroups,disabled:l.isEditing},null,8,["modelValue","rules","items","disabled"])]),_:1})):b("",!0),(d(!0),f(U,null,D(l.parentTerritories,(s,y)=>(d(),f(U,{key:s.type},[l.isFieldTerritoryType?(d(),h(g,{key:0,cols:"6"},{default:t(()=>[a(w,{modelValue:i.inputTerritory[s.type.toLowerCase()],"onUpdate:modelValue":[p=>i.inputTerritory[s.type.toLowerCase()]=p,l.setTerritoryParentId],rules:[p=>!!p||"Required"],disabled:y<l.inputParentTypes.length-1,label:s.type,items:s.items},null,8,["modelValue","onUpdate:modelValue","rules","disabled","label","items"])]),_:2},1024)):b("",!0)],64))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(G,{class:"justify-space-between"},{default:t(()=>[a(V,{onClick:l.cancelTerritorySave},{default:t(()=>[u(" Close ")]),_:1},8,["onClick"]),a(c,{disabled:!i.territoryInputValid,onClick:l.onSaveInputTerritory},{default:t(()=>[u(" Save ")]),_:1},8,["disabled","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(O,{modelValue:i.deleteDialog,"onUpdate:modelValue":e[8]||(e[8]=s=>i.deleteDialog=s),width:"344"},{default:t(()=>[a(A,null,{default:t(()=>[a(R,{class:"text-center text-wrap"},{default:t(()=>[u(" Are you sure you want to delete this territory? ")]),_:1}),a(B,{class:"text-center"},{default:t(()=>[u(" Territory "+m(i.currentItemToDelete?i.currentItemToDelete.name:""),1)]),_:1}),a(G,null,{default:t(()=>[a(_,{variant:"text",color:"error-lighten-2",onClick:l.removeTerritory},{default:t(()=>[u(" Yes ")]),_:1},8,["onClick"]),a(me),a(_,{variant:"text",onClick:l.cancelRemoveTerritory},{default:t(()=>[u(" No ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(v,null,{default:t(()=>[a(g,{cols:"12"},{default:t(()=>[a(C,{expanded:i.expandedModel,"onUpdate:expanded":e[12]||(e[12]=s=>i.expandedModel=s),headers:l.territoryHeaders,items:l.territoryItems,hover:"",loading:l.loading||i.isChangingTab,search:i.search,"loading-text":"Loading...","show-expand":"","custom-filter":l.territoryFilter},{["item.data-table-expand"]:t(({item:s})=>[a(_,{class:ee({"v-data-table__expand-icon--active":i.expandedModel.includes(s.id)}),icon:"$angleDown",variant:"flat",onClick:y=>l.setActiveRow(s)},null,8,["class","onClick"])]),"no-data":t(()=>[i.search?(d(),f("span",fe,[u(" Could not find any territories "),a(_,{class:"mx-3",color:"primary",size:"small",onClick:e[9]||(e[9]=s=>i.search="")},{default:t(()=>[u(" Clear filters ")]),_:1}),i.selectedTab!=="Home"?(d(),h(_,{key:0,color:"primary",size:"small",onClick:e[10]||(e[10]=s=>i.selectedTab="Home")},{default:t(()=>[u(" View "),a(E,{class:"ml-1",icon:"$vuetify.icons.solidHome",size:"small"})]),_:1})):b("",!0)])):i.apiErrorLog?(d(),f("span",Te," There was an error loading the data, please try again. ")):(d(),f("span",ge,m(r.tab==="Home"?"No territories":`No field territories under ${r.tab}`),1))]),top:t(()=>[a(L,{modelValue:i.search,"onUpdate:modelValue":e[11]||(e[11]=s=>i.search=s),label:"Search",variant:"underlined",class:"mx-4",clearable:""},null,8,["modelValue"])]),["item.district.name"]:t(({item:s,value:y})=>[T("td",null,[a(S,{label:"",onClick:p=>l.handleSearch(s.district.id)},{default:t(()=>[u(m(y),1)]),_:2},1032,["onClick"])])]),["item.District.name"]:t(({item:s,value:y})=>[T("td",null,[y?(d(),h(S,{key:0,label:"",onClick:p=>l.handleSearch(s.District.id)},{default:t(()=>[u(m(y),1)]),_:2},1032,["onClick"])):b("",!0)])]),["item.market.name"]:t(({item:s,value:y})=>[T("td",null,[a(S,{label:"",onClick:p=>l.handleSearch(s.market.id)},{default:t(()=>[u(m(y),1)]),_:2},1032,["onClick"])])]),["item.region.name"]:t(({item:s,value:y})=>[T("td",null,[a(S,{label:"",onClick:p=>l.handleSearch(s.region.id)},{default:t(()=>[u(m(y),1)]),_:2},1032,["onClick"])])]),[l.businessGroupColumnName]:t(({item:s,value:y})=>[T("td",null,[a(S,{label:"",onClick:p=>l.handleSearch(s["Business Group"].id)},{default:t(()=>[u(m(y),1)]),_:2},1032,["onClick"])])]),[l.marketSlashRegionColumnName]:t(({item:s,value:y})=>[T("td",null,[y?(d(),h(S,{key:0,label:"",onClick:p=>l.handleSearch(s["Market/Region"].id)},{default:t(()=>[u(m(y),1)]),_:2},1032,["onClick"])):b("",!0)])]),["item.primaryUser"]:t(({item:{primaryUser:s}})=>[u(m(l.fullnameFor(s)),1)]),["item.secondaryUser"]:t(({item:{secondaryUser:s}})=>[u(m(l.fullnameFor(s)),1)]),"expanded-row":t(({item:s,columns:y})=>[T("td",{colspan:y.length},[a(H,{class:"bg-surface-bright"},{default:t(()=>[l.userCanAdministerTerritories?(d(),h(v,{key:0},{default:t(()=>[a(P,{lines:"two"},{default:t(()=>[a(K,null,{default:t(()=>[be]),_:1}),T("div",null,[a(z,{location:"bottom"},{activator:t(({props:p})=>[a(_,re({class:"pa-0",color:"info",icon:"$vuetify.icons.edit",variant:"text"},p,{onClick:k=>l.openEditOn(s.id)}),null,16,["onClick"])]),default:t(()=>[_e]),_:2},1024),s.territoryType==="F"?(d(),h(z,{key:0,location:"bottom"},{activator:t(({props:p})=>[T("span",te(ie(p)),[a(_,{class:"pa-0 ml-2",color:"error-lighten-2",disabled:!l.canBeDeleted(s),icon:"$vuetify.icons.trash",variant:"text",onClick:k=>l.onClickDelete(s)},null,8,["disabled","onClick"])],16)]),default:t(()=>[T("span",null,m(l.canBeDeleted(s)?"Delete":"Can't delete with attached sites"),1)]),_:2},1024)):b("",!0)])]),_:2},1024)]),_:2},1024)):b("",!0),s.territoryType==="F"?(d(),h(v,{key:1},{default:t(()=>[a(g,null,{default:t(()=>[a(C,{headers:i.siteHeaders,loading:i.fieldSites[s.id].isLoadingSites,"loading-text":"loading...","items-per-page":"5",items:i.fieldSites[s.id].sites,hover:"",class:"expanded-table mb-6"},{top:t(()=>[ve]),["item.location.code"]:t(({item:p,value:k})=>[T("td",null,[l.userCanManageLocations?(d(),f("a",{key:0,rel:"external",target:"_blank",href:p.location.link},m(k),9,Ce)):(d(),f("span",Se,m(k),1))])]),["item.placement"]:t(({item:p,value:k})=>[T("td",null,[l.userCanManageLocations?(d(),f("a",{key:0,rel:"external",target:"_blank",href:p.link},m(k),9,Ve)):(d(),f("span",Ie,m(k),1))])]),["item.kiosk.serialNumber"]:t(({item:p,value:k})=>[T("td",null,[l.userCanViewKiosks?(d(),f("a",{key:0,rel:"external",target:"_blank",href:p.kiosk.link},m(k),9,xe)):(d(),f("span",Ue,m(k),1))])]),"no-data":t(()=>[i.fieldSites[s.id].apiError?(d(),f("span",we,m(i.fieldSites[s.id].apiError),1)):(d(),f("span",De," No sites attached. "))]),_:2},1032,["headers","loading","items"])]),_:2},1024),a(j)]),_:2},1024)):(d(),h(v,{key:2},{default:t(()=>[a(g,null,{default:t(()=>[a(P,{lines:"two"},{default:t(()=>[a(K,null,{default:t(()=>[u(m(l.childTerritoryType(s))+" territories under "+m(s.name),1)]),_:2},1024),(d(!0),f(U,null,D(l.availableTerritories[s.id],p=>(d(),h(S,{key:p.name,class:"ma-2",label:"",onClick:k=>l.handleSearch(p.id,"cardChip")},{default:t(()=>[u(m(p.name),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024),a(j)]),_:2},1024))]),_:2},1024)],8,ke)]),_:2},1032,["expanded","headers","items","loading","search","custom-filter"])]),_:1})]),_:1})]),_:1})}const qe=q(ye,[["render",Ee],["__scopeId","data-v-f7b71f14"]]);export{qe as default};
