import y from"./MeruDataTable.80a372ee.js";import{S as L,e as S,x as V,k as i,E as n,g as s,B as m,L as C,M as T,s as R,I as p,J as f}from"./@vue.ee679632.js";import{_ as B}from"./index.8a58b007.js";import{c as u,u as I,f as h,d as g,P as _,Q as N,q as v,D}from"./vuetify.65d833ec.js";import"./vuex.0eb68a2c.js";import"./date-fns.d38e1d55.js";import"./vue-atomic-docs.4f3653eb.js";import"./vue-router.ec64e966.js";import"./axios.eca6faa7.js";import"./axios-cache-interceptor.0956cad0.js";import"./cache-parser.124ebbb8.js";import"./fast-defer.b34f24de.js";import"./object-code.c2755e43.js";import"./@fortawesome.2cecc5e3.js";import"./@awesome.me.7dae7d79.js";const U={components:{MeruDataTable:y},props:{locations:{type:Array,required:!0},selectedLocationIds:{type:Array,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle-select-all","toggle-location-select","update:is-expanded","show-location"],expose:["scrollToLocation"],data(){return{sortBy:[{key:"name",order:"asc"}],filterString:"",expandedRows:[],tableHeaders:[{title:"",key:"data-table-select",width:40,headerProps:{class:"text-body-4 pa-0"}},{title:"Location",key:"name",width:150,headerProps:{class:"pl-0"}},{title:"ABN",key:"abn",width:100},{title:"# Kiosks",key:"kioskCount",headerProps:{class:"pr-0"}}],expandedTableHeaders:[{title:"Kiosk Serial Number",key:"serialNumber",sortable:!1},{title:"Machine Type",key:"machineType",sortable:!1}]}},computed:{isAllSelected:{get(){return this.selectedLocationIds.length===this.locations.length},set(t){this.$emit("toggle-select-all",t)}},isListOpen:{get(){return this.isExpanded},set(t){this.$emit("update:is-expanded",t)}},tableItems(){return this.locations.map(t=>({name:t.kiosks[0].locationName,abn:t.abn,kiosks:t.kiosks,kioskCount:t.kiosks.length,id:t.id}))}},watch:{isListOpen(t){t||(this.expandedRows=[])}},methods:{scrollToLocation(t){if(this.filterString="",this.isListOpen){const e=this.$refs[t];this.$refs["data-table"].$el.children[1].scrollTop=e.offsetTop-48}},customFilter(t,e,d){let c=!0;return e=e.toUpperCase(),e&&(c=d.raw.abn.toString().includes(e)||d.raw.name.toUpperCase().includes(e)||d.raw.kiosks.find(l=>l.serialNumber.includes(e))),!!c},navigate(){const t="https://www.google.com/maps/dir/?api=1&travelmode=driving&waypoints=";let e="";for(const d of this.locations.filter(c=>this.selectedLocationIds.includes(c.id))){const{latitude:c,longitude:l}=d.kiosks[0].site.location;e+=`${c},${l}|`}window.open(t+encodeURIComponent(e)+"&destination=My+Location")},toggleRowExpanded(t){this.expandedRows.includes(t)?this.expandedRows=[]:this.expandedRows=[t]}}},M={class:"route-planner-toolbar__row"},O={class:"pl-0 bg-transparent",colspan:"2"},A={class:"d-flex align-center"},E=["onClick"],P={class:"bg-transparent"},z={class:"bg-transparent pr-0"},F={class:"d-flex align-center justify-space-between"},H={class:"mr-2"},q=["colspan"],K={class:"route-planner-toolbar__row"},j={class:"text-body-2"};function J(t,e,d,c,l,r){const b=L("MeruDataTable");return S(),V(v,{class:"route-planner-toolbar"},{default:i(()=>[n("div",M,[s(I,{modelValue:l.filterString,"onUpdate:modelValue":e[0]||(e[0]=a=>l.filterString=a),flat:"",variant:"solo",placeholder:"Serial #, ABN, Store #",clearable:"","hide-details":"","single-line":"",onFocus:e[1]||(e[1]=a=>r.isListOpen=!0)},{"prepend-inner":i(()=>[s(u,{size:"small",icon:"$vuetify.icons.solidSearch"})]),_:1},8,["modelValue"]),s(h,{vertical:"",class:"mx-4"}),s(g,{icon:"",elevation:"0",onClick:e[2]||(e[2]=a=>r.isListOpen=!r.isListOpen)},{default:i(()=>[s(u,{class:m({"flip-icon":r.isListOpen}),size:"small",icon:"$vuetify.icons.chevronDown"},null,8,["class"])]),_:1})]),s(D,null,{default:i(()=>[C(s(b,{ref:"data-table","sort-by":l.sortBy,"onUpdate:sortBy":e[4]||(e[4]=a=>l.sortBy=a),expanded:l.expandedRows,"onUpdate:expanded":e[5]||(e[5]=a=>l.expandedRows=a),"model-value":d.selectedLocationIds,search:l.filterString,class:"mk-data-table","item-selectable":"id","fixed-header":"","items-per-page":-1,"show-select":"","no-data-text":"No Locations","no-results-text":"No Results",headers:l.tableHeaders,items:r.tableItems,"custom-filter":r.customFilter,width:"100%","hide-default-footer":""},{top:i(()=>[s(h)]),["header.data-table-select"]:i(({props:a})=>[s(_,R(a,{modelValue:r.isAllSelected,"onUpdate:modelValue":e[3]||(e[3]=o=>r.isAllSelected=o)}),null,16,["modelValue"])]),item:i(({isSelected:a,item:o,internalItem:x,isExpanded:w})=>[n("tr",{ref:`${o.id}`,class:m({"selected-list-item":a([{value:o.id}])})},[n("td",O,[n("div",A,[s(_,{class:"flex-grow-0","model-value":a([{value:o.id}]),"onUpdate:modelValue":k=>t.$emit("toggle-location-select",o.id)},null,8,["model-value","onUpdate:modelValue"]),n("div",{class:"location-name",onClick:k=>t.$emit("show-location",o.id)},p(o.name),9,E)])]),n("td",P,p(o.abn),1),n("td",z,[n("div",F,[n("span",H,p(o.kiosks.length),1),s(g,{icon:"",class:"elevation-0 bg-transparent",onClick:k=>r.toggleRowExpanded(o.id)},{default:i(()=>[s(u,{class:m(w(x)?"flip-icon":""),size:"small",icon:"$vuetify.icons.chevronDown"},null,8,["class"])]),_:2},1032,["onClick"])])])],2)]),"expanded-row":i(({columns:a,item:o})=>[n("td",{style:{background:"rgb(var(--v-theme-surface-light))"},colspan:a.length},[s(N,{class:"px-4"},{default:i(()=>[f(p(o.kiosks[0].locationName),1)]),_:2},1024),s(v,{variant:"outlined",class:"mb-4"},{default:i(()=>[s(b,{color:"meru-neutral-darken-1",density:"compact",headers:l.expandedTableHeaders,items:o.kiosks,"hide-default-footer":""},null,8,["headers","items"])]),_:2},1024)],8,q)]),_:2},1032,["sort-by","expanded","model-value","search","headers","items","custom-filter"]),[[T,r.isListOpen]])]),_:1}),s(h),n("div",K,[n("div",j,p(d.selectedLocationIds.length===0?"Select on Map or Search":`${d.selectedLocationIds.length} Location${d.selectedLocationIds.length===1?"":"s"} Selected`),1),s(g,{disabled:d.selectedLocationIds.length===0,variant:"flat",class:"bg-info",onClick:r.navigate},{default:i(()=>[s(u,{start:""},{default:i(()=>[f(" $vuetify.icons.directions ")]),_:1}),f(" Directions ")]),_:1},8,["disabled","onClick"])])]),_:1})}const de=B(U,[["render",J],["__scopeId","data-v-70821c83"]]);export{de as default};
