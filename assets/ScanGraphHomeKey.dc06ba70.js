import{o as h,_ as m}from"./index.8a58b007.js";import{C as u,q as _,r as f,s as g,w as y,x as S,y as D}from"./chart.js.00f608ba.js";import{L as x}from"./vue-chartjs.b3d57c2d.js";import{a as k}from"./chartjs-plugin-annotation.e3ca55a0.js";import{a as L}from"./lodash-es.d99d4c8c.js";import{at as I,am as C}from"./vuetify.65d833ec.js";import{S as v,L as b,e as c,f as H,x as l,k as z,B as E,aj as B,ak as O,E as R}from"./@vue.ee679632.js";import"./vuex.0eb68a2c.js";import"./date-fns.d38e1d55.js";import"./vue-atomic-docs.4f3653eb.js";import"./vue-router.ec64e966.js";import"./axios.eca6faa7.js";import"./axios-cache-interceptor.0956cad0.js";import"./cache-parser.124ebbb8.js";import"./fast-defer.b34f24de.js";import"./object-code.c2755e43.js";import"./@fortawesome.2cecc5e3.js";import"./@awesome.me.7dae7d79.js";import"./@kurkle.1fd9dacb.js";u.register(_,f,g,y,S,D,k);const Y={components:{LineChart:x},props:{scanId:{type:String,required:!0}},data:()=>({isLoadingScanData:!1,scanData:{shoulder_pos:void 0,end_of_key_pos:void 0,y:[],height:[],maxHeight:0,maxY:0}}),computed:{chartData(){let a=[],e=[];return this.scanData&&(a=this.scanData.y,e.push({label:"Height",data:this.scanData.height})),{labels:a,datasets:e}},chartOptions(){return{layout:{padding:10},elements:{line:{borderWidth:3,borderColor:"#00bcd4",tension:0},point:{pointStyle:!1}},scales:{x:{type:"linear",min:0,max:this.scanData.maxY+.02,ticks:{stepSize:.01}},y:{min:0,max:this.scanData.maxHeight+.05,ticks:{stepSize:.01}}},plugins:{title:{display:!0,text:this.scanId},tooltip:{mode:"index",intersect:!0},annotation:{annotations:[{id:"shoulder_pos",type:"line",scaleID:"x",value:this.scanData.shoulder_pos,endValue:this.scanData.shoulder_pos,borderColor:"red",label:{position:"start",content:"Shoulder",display:!0}},{id:"end_of_key_pos",type:"line",scaleID:"x",value:this.scanData.end_of_key_pos,endValue:this.scanData.end_of_key_pos,borderColor:"red",label:{position:"start",content:"Tip",display:!0}}]}}}}},mounted(){this.fetchScan()},methods:{async fetchScan(){this.isLoadingScanData=!0,this.scanData=void 0;try{const{data:a}=await h.fetchKeyProfile(this.scanId);this.scanData=this.parseScanData(a)}catch(a){console.log(a)}this.isLoadingScanData=!1},parseScanData(a){let e={shoulder_pos:void 0,end_of_key_pos:void 0,y:[],height:[],maxHeight:0,maxY:0};const[p,d]=a.includes("SIGNALS")?a.split(`SIGNALS
`):a.split(`POINTS
`);p.split(`
`).forEach(t=>{const[s,i]=t.split(": ");["shoulder_pos","end_of_key_pos"].includes(s)&&(e[s]=parseFloat(i))});const o=d.split(`
`).map(t=>t.split(" ")),n=o[0].indexOf("y"),r=o[0].indexOf("height");return o.slice(1).forEach(t=>{const s=parseFloat(t[n]),i=parseFloat(t[r]);e.y.push(s),e.height.push(i),s>e.maxY&&(e.maxY=s),i>e.maxHeight&&(e.maxHeight=i)}),e},onResize:L(function(){var a,e;(e=(a=this.$refs.lineChart)==null?void 0:a.chart)==null||e.resize()},300)}},w=a=>(B("data-v-01e6316f"),a=a(),O(),a),F=w(()=>R("div",{class:"w-100 text-center"}," Failed to load scan data ",-1));function G(a,e,p,d,o,n){const r=v("LineChart");return b((c(),H("div",{class:E(["scan-graph-home-key",{"scan-graph-home-key--loading":a.isLoadingScanData,"scan-graph-home-key--error":!a.isLoadingScanData&&!a.scanData}])},[a.isLoadingScanData||!a.scanData?(c(),l(C,{key:0,type:"ossein",loading:a.isLoadingScanData,class:"scan-graph-home-key__loader"},{default:z(()=>[F]),_:1},8,["loading"])):(c(),l(r,{key:1,ref:"lineChart",data:n.chartData,options:n.chartOptions,class:"scan-graph-home-key__line-chart"},null,8,["data","options"]))],2)),[[I,n.onResize,void 0,{quiet:!0}]])}const sa=m(Y,[["render",G],["__scopeId","data-v-01e6316f"]]);export{sa as default};
