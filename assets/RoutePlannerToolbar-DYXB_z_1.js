import y from"./MeruDataTable-jf3gvfqw.js";import{C as L,i,B as n,e as s,x as m,N as S,O as V,_ as C,J as f,H as p,p as T,A as B}from"./@vue-DNrUJgob.js";import{_ as N}from"./index-LK9MQE2L.js";import{d as u,u as R,f as h,b as g,P as I,l as v,Q as x,D}from"./vuetify-BgnNF2O3.js";import"./vuex-D3TwipD2.js";import"./date-fns-2ylUqVpG.js";import"./@babel-BTTPuEuv.js";import"./vue-component-docs-plugin-BnqcuvvC.js";import"./vue-router-BVOKdCCq.js";import"./axios-xsH4HHeE.js";import"./axios-cache-interceptor-DgAMPFM2.js";import"./cache-parser-DXYp_BCq.js";import"./fast-defer-9MI9za_P.js";import"./object-code-SBtdq8jY.js";import"./@fortawesome-BWcQmPY7.js";import"./@awesome.me-Btqfd-fw.js";const U={components:{MeruDataTable:y},props:{locations:{type:Array,required:!0},selectedLocationIds:{type:Array,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle-select-all","toggle-location-select","update:is-expanded","show-location"],expose:["scrollToLocation"],data(){return{sortBy:[{key:"name",order:"asc"}],filterString:"",expandedRows:[],tableHeaders:[{title:"",key:"data-table-select",width:40,headerProps:{class:"text-body-4 pa-0"}},{title:"Location",key:"name",width:150,headerProps:{class:"pl-0"}},{title:"ABN",key:"abn",width:100},{title:"# Kiosks",key:"kioskCount",headerProps:{class:"pr-0"}}],expandedTableHeaders:[{title:"Kiosk Serial Number",key:"serialNumber",sortable:!1},{title:"Machine Type",key:"machineType",sortable:!1}]}},computed:{isAllSelected:{get(){return this.selectedLocationIds.length===this.locations.length},set(t){this.$emit("toggle-select-all",t)}},isListOpen:{get(){return this.isExpanded},set(t){this.$emit("update:is-expanded",t)}},tableItems(){return this.locations.map(t=>({name:t.kiosks[0].locationName,abn:t.abn,kiosks:t.kiosks,kioskCount:t.kiosks.length,id:t.id}))}},watch:{isListOpen(t){t||(this.expandedRows=[])}},methods:{scrollToLocation(t){if(this.filterString="",this.isListOpen){const e=this.$refs[t];this.$refs["data-table"].$el.children[1].scrollTop=e.offsetTop-48}},customFilter(t,e,d){let c=!0;return e=e.toUpperCase(),e&&(c=d.raw.abn.toString().includes(e)||d.raw.name.toUpperCase().includes(e)||d.raw.kiosks.find(l=>l.serialNumber.includes(e))),!!c},navigate(){const t="https://www.google.com/maps/dir/?api=1&travelmode=driving&waypoints=";let e="";for(const d of this.locations.filter(c=>this.selectedLocationIds.includes(c.id))){const{latitude:c,longitude:l}=d.kiosks[0].site.location;e+=`${c},${l}|`}window.open(t+encodeURIComponent(e)+"&destination=My+Location")},toggleRowExpanded(t){this.expandedRows.includes(t)?this.expandedRows=[]:this.expandedRows=[t]}}},O={class:"route-planner-toolbar__row"},A={class:"pl-0 bg-transparent",colspan:"2"},M={class:"d-flex align-center"},E=["onClick"],P={class:"bg-transparent"},H={class:"bg-transparent pr-0"},z={class:"d-flex align-center justify-space-between"},F={class:"mr-2"},q=["colspan"],K={class:"route-planner-toolbar__row"},j={class:"text-body-2"};function J(t,e,d,c,l,r){const b=C("MeruDataTable");return B(),L(v,{class:"route-planner-toolbar"},{default:i(()=>[n("div",O,[s(R,{modelValue:l.filterString,"onUpdate:modelValue":e[0]||(e[0]=o=>l.filterString=o),flat:"",variant:"solo",placeholder:"Serial #, ABN, Store #",clearable:"","hide-details":"","single-line":"",onFocus:e[1]||(e[1]=o=>r.isListOpen=!0)},{"prepend-inner":i(()=>[s(u,{size:"small",icon:"$vuetify.icons.solidSearch"})]),_:1},8,["modelValue"]),s(h,{vertical:"",class:"mx-4"}),s(g,{icon:"",elevation:"0",onClick:e[2]||(e[2]=o=>r.isListOpen=!r.isListOpen)},{default:i(()=>[s(u,{class:m({"flip-icon":r.isListOpen}),size:"small",icon:"$vuetify.icons.chevronDown"},null,8,["class"])]),_:1})]),s(D,null,{default:i(()=>[S(s(b,{ref:"data-table","sort-by":l.sortBy,"onUpdate:sortBy":e[4]||(e[4]=o=>l.sortBy=o),expanded:l.expandedRows,"onUpdate:expanded":e[5]||(e[5]=o=>l.expandedRows=o),"model-value":d.selectedLocationIds,search:l.filterString,class:"mk-data-table","item-selectable":"id","fixed-header":"","items-per-page":-1,"show-select":"","no-data-text":"No Locations","no-results-text":"No Results",headers:l.tableHeaders,items:r.tableItems,"custom-filter":r.customFilter,width:"100%","hide-default-footer":""},{top:i(()=>[s(h)]),"header.data-table-select":i(({props:o})=>[s(x,T(o,{modelValue:r.isAllSelected,"onUpdate:modelValue":e[3]||(e[3]=a=>r.isAllSelected=a)}),null,16,["modelValue"])]),item:i(({isSelected:o,item:a,internalItem:w,isExpanded:_})=>[n("tr",{ref:`${a.id}`,class:m({"selected-list-item":o([{value:a.id}])})},[n("td",A,[n("div",M,[s(x,{class:"flex-grow-0","model-value":o([{value:a.id}]),"onUpdate:modelValue":k=>t.$emit("toggle-location-select",a.id)},null,8,["model-value","onUpdate:modelValue"]),n("div",{class:"location-name",onClick:k=>t.$emit("show-location",a.id)},p(a.name),9,E)])]),n("td",P,p(a.abn),1),n("td",H,[n("div",z,[n("span",F,p(a.kiosks.length),1),s(g,{icon:"",class:"elevation-0 bg-transparent",onClick:k=>r.toggleRowExpanded(a.id)},{default:i(()=>[s(u,{class:m(_(w)?"flip-icon":""),size:"small",icon:"$vuetify.icons.chevronDown"},null,8,["class"])]),_:2},1032,["onClick"])])])],2)]),"expanded-row":i(({columns:o,item:a})=>[n("td",{style:{background:"rgb(var(--v-theme-surface-light))"},colspan:o.length},[s(I,{class:"px-4"},{default:i(()=>[f(p(a.kiosks[0].locationName),1)]),_:2},1024),s(v,{variant:"outlined",class:"mb-4"},{default:i(()=>[s(b,{color:"meru-neutral-darken-1",density:"compact",headers:l.expandedTableHeaders,items:a.kiosks,"hide-default-footer":""},null,8,["headers","items"])]),_:2},1024)],8,q)]),_:2},1032,["sort-by","expanded","model-value","search","headers","items","custom-filter"]),[[V,r.isListOpen]])]),_:1}),s(h),n("div",K,[n("div",j,p(d.selectedLocationIds.length===0?"Select on Map or Search":`${d.selectedLocationIds.length} Location${d.selectedLocationIds.length===1?"":"s"} Selected`),1),s(g,{disabled:d.selectedLocationIds.length===0,variant:"flat",class:"bg-info",onClick:r.navigate},{default:i(()=>[s(u,{start:""},{default:i(()=>e[6]||(e[6]=[f(" $vuetify.icons.directions ")])),_:1,__:[6]}),e[7]||(e[7]=f(" Directions "))]),_:1,__:[7]},8,["disabled","onClick"])])]),_:1})}const re=N(U,[["render",J],["__scopeId","data-v-70821c83"]]);export{re as default};
