import{b as j,m as W,a as F}from"./vuex-D3TwipD2.js";import{_ as Y,v as N,T as J}from"./index-LK9MQE2L.js";import q from"./MeruDataTable-jf3gvfqw.js";import Q from"./DefaultLayout-DdfUBm6-.js";import{C as T,i as t,e as a,N as X,J as u,H as m,O as Z,B as h,s as b,b as c,g as D,F as U,_ as I,p as $,k as ee,l as re,x as te,A as d}from"./@vue-DNrUJgob.js";import{a2 as ie,a6 as se,w as g,T as le,b as v,x as _,d as E,ax as ae,l as A,m as M,t as R,n as ne,aj as B,u as H,ai as w,r as L,k as O,i as oe,V as G,a as P,s as K,f as z,v as V,U as de}from"./vuetify-BgnNF2O3.js";import"./date-fns-2ylUqVpG.js";import"./@babel-BTTPuEuv.js";import"./vue-component-docs-plugin-BnqcuvvC.js";import"./vue-router-BVOKdCCq.js";import"./axios-xsH4HHeE.js";import"./axios-cache-interceptor-DgAMPFM2.js";import"./cache-parser-DXYp_BCq.js";import"./fast-defer-9MI9za_P.js";import"./object-code-SBtdq8jY.js";import"./@fortawesome-BWcQmPY7.js";import"./@awesome.me-Btqfd-fw.js";const ue={components:{MeruDataTable:q,DefaultLayout:Q},data(){return{apiErrorLog:"",dialogTerritory:!1,valid:!1,search:null,baseTerritoryHeaders:[{sortable:!0,groupable:!1,align:"start",title:"Name",key:"name"},{sortable:!0,groupable:!0,align:"right",title:"Primary KT",key:"primaryUser"},{sortable:!0,groupable:!0,align:"right",title:"Secondary KT",key:"secondaryUser"}],homeHeaders:[{sortable:!0,groupable:!0,title:"Type",key:"territoryTypeName"},{sortable:!0,groupable:!0,title:"Business Group",key:"Business Group.name"},{sortable:!0,groupable:!0,title:"Market/Region",key:"Market/Region.name"},{sortable:!0,groupable:!0,title:"District",key:"District.name"}],rdsHeaders:[{sortable:!0,groupable:!0,title:"Market",key:"market.name"}],salesServiceHeaders:[{sortable:!0,groupable:!0,title:"Region",key:"region.name"},{sortable:!0,groupable:!0,title:"District",key:"district.name"}],siteHeaders:[{sortable:!0,title:"Code",key:"location.code"},{sortable:!0,title:"Location",key:"location.name"},{sortable:!0,title:"Placement",key:"placement"},{sortable:!0,title:"Kiosk",key:"kiosk.serialNumber"},{sortable:!0,title:"Grade",key:"grade"}],selectedTab:"Home",currentEditItem:null,territoryInputValid:!1,inputTerritory:{name:"",territoryType:"Field",group:void 0,market:void 0,region:void 0,district:void 0,primaryUser:"",secondaryUser:""},groups:{RDS:{territoryTypes:["Field","Market"]},default:{territoryTypes:["Field","District","Region"]}},isShowEveryone:!0,expanded:[],expandedModel:[],deleteDialog:!1,currentItemToDelete:null,addOrEditRules:[r=>!!r||"Required",()=>!this.existingInputTerritory||this.sameTerritory(this.currentEditItem,this.existingInputTerritory)||`${this.inputTerritory.name} under ${this.inputParentTypes[0]} ${this.inputParent.name} already exists!`,r=>this.inputTerritory.territoryType[0]!=="F"||!this.inputGroup||this.inputGroup.name==="RDS"||!!String(r).match(/^[0-9]{3}$/)||"Name must be a 3 digit number from 001-999!"],fieldSites:{},allAvailableTabs:["Home","RDS","Field Sales","Field Service"],isChangingTab:!1}},computed:{...F("territories",["userTerritories","loadingUserTerritories","loadingAllTerritories","allTerritories","territoryUsers","loadingUsers","apiError"]),...F("user",["permissions"]),...W("territories",["flatAllTerritories","flatUserTerritories"]),allTerritoryUsers(){return{...this.territoryUsers.fieldUsers,...this.territoryUsers.managers}},allTerritoriesToShow(){return this.isShowEveryone?this.allTerritories:this.userTerritories},flatTerritoriesToShow(){return this.isShowEveryone?this.flatAllTerritories:this.flatUserTerritories},territoryItems(){var r=[];if(this.selectedTab==="RDS"){const e=this.allTerritoriesToShow.find(i=>i.name==="RDS");r=(e?e.children:[]).flatMap(i=>i.children.map(l=>({...l,market:{name:i.name,id:i.id}})))}else if(this.selectedTab==="Home")r=this.flatTerritoriesToShow;else{const e=this.allTerritoriesToShow.find(i=>i.name===this.selectedTab);r=(e?e.children:[]).flatMap(i=>i.children.flatMap(l=>l.children.map(f=>({...f,region:{name:i.name,id:i.id},district:{name:l.name,id:l.id}}))))}return r.map(e=>{const{primaryUser:n,secondaryUser:o}=e;return{...e,primaryUser:n||"",secondaryUser:o||"",territoryTypeName:N(e)}})},territoryHeaders(){const[r,e,n]=this.baseTerritoryHeaders;switch(this.selectedTab){case"Home":return[r,...this.homeHeaders,e,n];case"RDS":return[r,...this.rdsHeaders,e,n];case"Field Sales":case"Field Service":return[r,...this.salesServiceHeaders,e,n];default:return[]}},loading(){return this.isShowEveryone?this.loadingAllTerritories||this.loadingUsers:this.loadingUserTerritories||this.loadingUsers},tabs(){return["Home",...this.allAvailableTabs.filter(e=>this.allTerritoriesToShow.find(({name:n})=>n===e))]},userCanAdministerTerritories(){return this.permissions.indexOf("AdministerTerritories")>=0},userCanManageLocations(){return this.permissions.indexOf("ManageLocations")},userCanViewKiosks(){return this.permissions.indexOf("ViewKiosks")},existingInputTerritory(){return this.flatAllTerritories.find(r=>this.sameTerritory(r,this.normalizedInput))},userOptions(){var n;const r=((n=this.inputTerritory)==null?void 0:n.territoryType)==="Field"?"fieldUsers":"managers",e=this.territoryUsers[r]||{};return Object.keys(e).sort((o,i)=>{const l=`${e[o].lastName},${e[o].firstName}.${e[o].email}`,f=`${e[i].lastName},${e[i].firstName}.${e[i].email}`;return l<f?-1:l>f?1:0}).map(o=>({...e[o],username:o,identifier:`${this.fullnameFor(o)} (${e[o].email})`}))},inputTerritoryTypes(){const r=this.allTerritories.find(e=>this.inputTerritory.group===e.id);return r?(this.groups[r&&r.name]||this.groups.default).territoryTypes:[]},inputParentTypes(){const r=this.inputTerritoryTypes.indexOf(this.inputTerritory.territoryType);return r>=0?this.inputTerritoryTypes.slice(r+1):[]},inputParent(){const r=this.inputParentTypes[0];if(r)return this.flatAllTerritories.find(e=>e.id===this.inputTerritory[r.toLowerCase()])},inputGroup(){return this.allTerritories.find(r=>this.inputTerritory.group===r.id)},normalizedInput(){return this.inputTerritory&&{name:this.inputTerritory.name,parentId:this.inputTerritory.parentId,primaryUser:this.inputTerritory.primaryUser,secondaryUser:this.inputTerritory.secondaryUser}},isEditing(){return this.currentEditItem!==null},businessGroupColumnName(){return"item.Business Group.name"},marketSlashRegionColumnName(){return"item.Market/Region.name"},addOrEditTitle(){return this.isEditing?`Editing Territory - ${this.currentEditItem.name||""}`:"Add Territory"},isFieldTerritoryType(){return this.inputTerritory.territoryType[0]==="F"},territoryBusinessGroups(){return this.allTerritories.map(({id:r,name:e})=>({title:e,value:r}))},parentTerritories(){return[...this.inputParentTypes].reverse().map(e=>({type:e,items:this.territoriesOfType(e).map(n=>({title:n.name,value:n.id}))}))},availableTerritories(){let r={};return this.expandedModel.forEach(e=>{const n=this.territoryWithId(e);r[e]=this.flatAllTerritories.filter(({parentId:o})=>o===n.id)}),r}},watch:{apiError(){this.apiErrorLog+=this.apiError+`
`},async inputParent(){this.$refs.nameInput&&await this.$refs.nameInput.validate()},selectedTab(){this.isChangingTab=!0,setTimeout(()=>{this.isChangingTab=!1},1e3)}},mounted(){this.userCanAdministerTerritories&&this.loadAllTerritories()},beforeMount(){this.loadUserTerritories(),this.loadTerritoryUsers()},methods:{...j("territories",["loadUserTerritories","loadAllTerritories","loadTerritoryUsers","updateTerritory","deleteTerritory"]),territoryTypeName:N,setTerritoryParentId(r){let e=this.territoryWithId(r);this.inputTerritory.parentId=(e==null?void 0:e.id)||void 0,(e==null?void 0:e.territoryType)==="D"&&(this.inputTerritory.region=e.parentId)},territoryWithId(r){return this.flatAllTerritories.find(e=>e.id===r)},setActiveRow(r){if(this.expandedModel.includes(r.id)){this.expandedModel=this.expandedModel.filter(e=>e!==r.id),this.expanded=this.expanded.filter(e=>e.id!==r.id);return}this.expandedModel.push(r.id),this.expanded.push(r),r.territoryType==="F"&&this.getTerritorySites(r)},sameTerritory(r,e){if(!r||!e)return!1;let n=(r.name||"").trim()===(e.name||"").trim(),o=r.parentId===e.parentId||!r.parentId&&!e.parentId;return n&&o},personFor(r){return this.allTerritoryUsers[r]||{firstName:r?`[username:${r}]`:"",lastName:""}},fullnameFor(r){const e=this.personFor(r);return`${e.firstName} ${e.lastName}`},territoryFilter(r,e,n){return e?r?e.indexOf(":")>=0?e.split(";").every(o=>{const[i,l]=o.split(":"),f=l.trim();if(["Market","Region"].includes(i)&&n.raw["Market/Region"])return n.raw["Market/Region"].name.toString()===f;if(this.selectedTab!=="Home"&&i==="Business Group")return this.selectedTab.toLowerCase()===f.toLowerCase();const S=this.territoryHeaders.filter(({title:x})=>x===i).map(({key:x})=>x)[0],C=S?n.columns[S]:n.columns[i];return C?C.toString().trim()===f:f==="[None]"}):Object.entries(n.columns).some(([o,i])=>{let f=["primaryUser","secondaryUser"].includes(o)?this.fullnameFor(i):i;return f==null?void 0:f.toLowerCase().includes(e.toString().toLowerCase())}):e==="[None]":!0},startAddFieldTerritory(){this.dialogTerritory=!0,this.inputTerritory.territoryType="Field"},territoriesOfType(r){return this.flatAllTerritories.filter(e=>e.territoryType[0]===r[0]&&e["Business Group"].id===this.inputGroup.id)},async onSaveInputTerritory(){var e,n;const{valid:r}=await this.$refs.addOrEditForm.validate();r&&(this.updateTerritory({id:(e=this.currentEditItem)==null?void 0:e.id,territoryUpdate:this.normalizedInput,isField:((n=this.currentEditItem)==null?void 0:n.territoryType)==="F"}),this.currentEditItem&&(this.expandedModel=this.expandedModel.filter(o=>o!==this.currentEditItem.id)),this.currentEditItem=null,this.$refs.addOrEditForm.reset(),this.dialogTerritory=!1)},openEditOn(r){var n,o,i;const e=this.territoryWithId(r);this.currentEditItem=e,this.dialogTerritory=!0,this.inputTerritory.name=e.name,this.inputTerritory.territoryType=this.territoryTypeName(e),this.inputTerritory.group=e["Business Group"].id,e.District?this.inputTerritory.district=(n=e.District)==null?void 0:n.id:this.inputTerritory.district=void 0,e["Business Group"].name==="RDS"?(this.inputTerritory.market=(o=e["Market/Region"])==null?void 0:o.id,this.inputTerritory.region=void 0):(this.inputTerritory.market=void 0,this.inputTerritory.region=(i=e["Market/Region"])==null?void 0:i.id),this.inputTerritory.primaryUser=e.primaryUser,this.inputTerritory.secondaryUser=e.secondaryUser,this.inputTerritory.parentId=e.parentId},childTerritoryType({name:r,territoryType:e,"Business Group":n}){if(e[0]==="G")return(this.groups[r]||this.groups.default).territoryTypes.at(-1);{const o=(this.groups[n&&n.name]||this.groups.default).territoryTypes;return o[o.map(i=>i[0]).indexOf(e)-1]}},canBeDeleted(r){var e,n;return!((n=(e=this.fieldSites[r.id])==null?void 0:e.sites)!=null&&n.length)},onClickDelete(r){this.deleteDialog=!0,this.currentItemToDelete=r},resetTable(){this.selectedTab="Home",this.search="",this.expandedModel=[]},removeTerritory(){this.currentItemToDelete&&(this.deleteTerritory(this.currentItemToDelete),this.deleteDialog=!1)},handleSearch(r,e="rowChip"){const n=this.territoryWithId(r),o=this.territoryWithId(n.parentId),i=e==="rowChip";if(!o)this.search=`Business Group:${n.name}`,this.selectedTab="Home";else{let l=this.childTerritoryType(o),S=`${l==="Field"||i?"Name":l}:${n.name.trim()}`,C=`${this.territoryTypeName(o)}:${o.name}`;this.search=`${S};${C}`,this.selectedTab=i?"Home":n["Business Group"].name}this.setActiveRow(n)},async getTerritorySites(r){this.fieldSites[r.id]={isLoadingSites:!0,apiError:""};try{let e=await J.getTerritoryData(r);this.fieldSites[r.id].sites=e.data.sites}catch{this.fieldSites[r.id].apiError="There was an error loading the data, please try again."}this.fieldSites[r.id].isLoadingSites=!1},cancelTerritorySave(){this.dialogTerritory=!1,this.currentEditItem=null},cancelRemoveTerritory(){this.deleteDialog=!1,this.currentItemToDelete=null}}},me={key:1},pe={key:1},ye={key:0,class:"on-surface-low-contrast-text"},fe={key:1},Te={key:2,class:"on-surface-low-contrast-text"},he=["colspan"],ce=["href"],ge={key:1},ke=["href"],be={key:1},ve=["href"],_e={key:1},Ce={key:0},Ve={key:1};function Se(r,e,n,o,i,l){const f=I("VBtnPrimary"),S=I("VBtnSecondary"),C=I("MeruDataTable"),x=I("DefaultLayout");return d(),T(x,null,{default:t(()=>[a(se,null,{default:t(()=>[a(ie,{"model-value":!!i.apiErrorLog,closable:"",icon:"$vuetify.icons.exclamationTriangle",type:"error"},{default:t(()=>[u(m(i.apiErrorLog),1)]),_:1},8,["model-value"])]),_:1}),X(h("div",null,[a(_,{dense:""},{default:t(()=>[a(g,{cols:"11",justify:"center"},{default:t(()=>[a(le,{modelValue:i.selectedTab,"onUpdate:modelValue":e[0]||(e[0]=s=>i.selectedTab=s),"show-arrows":""},{default:t(()=>[(d(!0),c(U,null,D(l.tabs,s=>(d(),T(de,{key:s,value:s},{default:t(()=>[s==="Home"?(d(),T(E,{key:0},{default:t(()=>e[13]||(e[13]=[u(" $vuetify.icons.solidHome ")])),_:1,__:[13]})):(d(),c("span",me,m(s),1))]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(g,{cols:"1",class:"d-flex justify-center align-center"},{default:t(()=>[a(v,{icon:"$vuetify.icons.undo",variant:"text",onClick:l.resetTable},null,8,["onClick"])]),_:1})]),_:1}),l.userCanAdministerTerritories?(d(),T(_,{key:0},{default:t(()=>[a(g,{cols:"6"},{default:t(()=>[a(f,{icon:r.$vuetify.display.xs,onClick:l.startAddFieldTerritory},{default:t(()=>[r.$vuetify.display.xs?(d(),T(E,{key:0},{default:t(()=>e[14]||(e[14]=[u(" $vuetify.icons.plus ")])),_:1,__:[14]})):(d(),c("span",pe,"Add Field Territory"))]),_:1},8,["icon","onClick"])]),_:1}),l.userCanAdministerTerritories?(d(),T(g,{key:0,cols:"6",align:"right"},{default:t(()=>[l.userCanAdministerTerritories?(d(),T(ae,{key:0,modelValue:i.isShowEveryone,"onUpdate:modelValue":e[1]||(e[1]=s=>i.isShowEveryone=s),mandatory:"force",divided:"",color:"surface-light",border:""},{default:t(()=>[a(v,{value:!1},{default:t(()=>e[15]||(e[15]=[u(" Me ")])),_:1,__:[15]}),a(v,{value:!0},{default:t(()=>e[16]||(e[16]=[u(" Everyone ")])),_:1,__:[16]})]),_:1},8,["modelValue"])):b("",!0)]),_:1})):b("",!0)]),_:1})):b("",!0)],512),[[Z,!r.loadingUserTerritories]]),a(O,{modelValue:i.dialogTerritory,"onUpdate:modelValue":e[7]||(e[7]=s=>i.dialogTerritory=s),"max-width":"800px"},{default:t(()=>[a(A,null,{default:t(()=>[a(M,null,{default:t(()=>[u(m(l.addOrEditTitle),1)]),_:1}),a(R,null,{default:t(()=>[a(ne,{ref:"addOrEditForm",modelValue:i.territoryInputValid,"onUpdate:modelValue":e[6]||(e[6]=s=>i.territoryInputValid=s)},{default:t(()=>[a(B,null,{default:t(()=>[a(_,null,{default:t(()=>[a(g,null,{default:t(()=>[a(H,{ref:"nameInput",modelValue:i.inputTerritory.name,"onUpdate:modelValue":e[2]||(e[2]=s=>i.inputTerritory.name=s),label:"Territory Name",disabled:!l.isFieldTerritoryType,rules:i.addOrEditRules,variant:"underlined"},null,8,["modelValue","disabled","rules"])]),_:1})]),_:1}),a(_,null,{default:t(()=>[a(g,{cols:"6"},{default:t(()=>[a(w,{modelValue:i.inputTerritory.primaryUser,"onUpdate:modelValue":e[3]||(e[3]=s=>i.inputTerritory.primaryUser=s),rules:[s=>!!s||"Required"],label:"Primary KT",items:l.userOptions,"item-title":"identifier","item-value":"username",class:"kt-autocomplete-input","menu-props":{width:"500"}},null,8,["modelValue","rules","items"])]),_:1}),a(g,{cols:"6"},{default:t(()=>[a(w,{modelValue:i.inputTerritory.secondaryUser,"onUpdate:modelValue":e[4]||(e[4]=s=>i.inputTerritory.secondaryUser=s),label:"Secondary KT",items:l.userOptions,"item-title":"identifier","item-value":"username",clearable:"",class:"kt-autocomplete-input","menu-props":{width:"500"}},null,8,["modelValue","items"])]),_:1}),l.isFieldTerritoryType?(d(),T(g,{key:0,cols:"6"},{default:t(()=>[a(w,{modelValue:i.inputTerritory.group,"onUpdate:modelValue":e[5]||(e[5]=s=>i.inputTerritory.group=s),label:"Business Group",rules:[s=>!!s||"Required"],items:l.territoryBusinessGroups,disabled:l.isEditing},null,8,["modelValue","rules","items","disabled"])]),_:1})):b("",!0),(d(!0),c(U,null,D(l.parentTerritories,(s,y)=>(d(),c(U,{key:s.type},[l.isFieldTerritoryType?(d(),T(g,{key:0,cols:"6"},{default:t(()=>[a(w,{modelValue:i.inputTerritory[s.type.toLowerCase()],"onUpdate:modelValue":[p=>i.inputTerritory[s.type.toLowerCase()]=p,l.setTerritoryParentId],rules:[p=>!!p||"Required"],disabled:y<l.inputParentTypes.length-1,label:s.type,items:s.items},null,8,["modelValue","onUpdate:modelValue","rules","disabled","label","items"])]),_:2},1024)):b("",!0)],64))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(L,{class:"justify-space-between"},{default:t(()=>[a(S,{onClick:l.cancelTerritorySave},{default:t(()=>e[17]||(e[17]=[u(" Close ")])),_:1,__:[17]},8,["onClick"]),a(f,{disabled:!i.territoryInputValid,onClick:l.onSaveInputTerritory},{default:t(()=>e[18]||(e[18]=[u(" Save ")])),_:1,__:[18]},8,["disabled","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(O,{modelValue:i.deleteDialog,"onUpdate:modelValue":e[8]||(e[8]=s=>i.deleteDialog=s),width:"344"},{default:t(()=>[a(A,null,{default:t(()=>[a(M,{class:"text-center text-wrap"},{default:t(()=>e[19]||(e[19]=[u(" Are you sure you want to delete this territory? ")])),_:1,__:[19]}),a(R,{class:"text-center"},{default:t(()=>[u(" Territory "+m(i.currentItemToDelete?i.currentItemToDelete.name:""),1)]),_:1}),a(L,null,{default:t(()=>[a(v,{variant:"text",color:"error-lighten-2",onClick:l.removeTerritory},{default:t(()=>e[20]||(e[20]=[u(" Yes ")])),_:1,__:[20]},8,["onClick"]),a(oe),a(v,{variant:"text",onClick:l.cancelRemoveTerritory},{default:t(()=>e[21]||(e[21]=[u(" No ")])),_:1,__:[21]},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(_,null,{default:t(()=>[a(g,{cols:"12"},{default:t(()=>[a(C,{expanded:i.expandedModel,"onUpdate:expanded":e[12]||(e[12]=s=>i.expandedModel=s),headers:l.territoryHeaders,items:l.territoryItems,hover:"",loading:l.loading||i.isChangingTab,search:i.search,"loading-text":"Loading...","show-expand":"","custom-filter":l.territoryFilter},{"item.data-table-expand":t(({item:s})=>[a(v,{class:te({"v-data-table__expand-icon--active":i.expandedModel.includes(s.id)}),icon:"$angleDown",variant:"flat",onClick:y=>l.setActiveRow(s)},null,8,["class","onClick"])]),"no-data":t(()=>[i.search?(d(),c("span",ye,[e[24]||(e[24]=u(" Could not find any territories ")),a(v,{class:"mx-3",color:"primary",size:"small",onClick:e[9]||(e[9]=s=>i.search="")},{default:t(()=>e[22]||(e[22]=[u(" Clear filters ")])),_:1,__:[22]}),i.selectedTab!=="Home"?(d(),T(v,{key:0,color:"primary",size:"small",onClick:e[10]||(e[10]=s=>i.selectedTab="Home")},{default:t(()=>[e[23]||(e[23]=u(" View ")),a(E,{class:"ml-1",icon:"$vuetify.icons.solidHome",size:"small"})]),_:1,__:[23]})):b("",!0)])):i.apiErrorLog?(d(),c("span",fe," There was an error loading the data, please try again. ")):(d(),c("span",Te,m(r.tab==="Home"?"No territories":`No field territories under ${r.tab}`),1))]),top:t(()=>[a(H,{modelValue:i.search,"onUpdate:modelValue":e[11]||(e[11]=s=>i.search=s),label:"Search",variant:"underlined",class:"mx-4",clearable:""},null,8,["modelValue"])]),"item.district.name":t(({item:s,value:y})=>[h("td",null,[a(V,{label:"",onClick:p=>l.handleSearch(s.district.id)},{default:t(()=>[u(m(y),1)]),_:2},1032,["onClick"])])]),"item.District.name":t(({item:s,value:y})=>[h("td",null,[y?(d(),T(V,{key:0,label:"",onClick:p=>l.handleSearch(s.District.id)},{default:t(()=>[u(m(y),1)]),_:2},1032,["onClick"])):b("",!0)])]),"item.market.name":t(({item:s,value:y})=>[h("td",null,[a(V,{label:"",onClick:p=>l.handleSearch(s.market.id)},{default:t(()=>[u(m(y),1)]),_:2},1032,["onClick"])])]),"item.region.name":t(({item:s,value:y})=>[h("td",null,[a(V,{label:"",onClick:p=>l.handleSearch(s.region.id)},{default:t(()=>[u(m(y),1)]),_:2},1032,["onClick"])])]),[l.businessGroupColumnName]:t(({item:s,value:y})=>[h("td",null,[a(V,{label:"",onClick:p=>l.handleSearch(s["Business Group"].id)},{default:t(()=>[u(m(y),1)]),_:2},1032,["onClick"])])]),[l.marketSlashRegionColumnName]:t(({item:s,value:y})=>[h("td",null,[y?(d(),T(V,{key:0,label:"",onClick:p=>l.handleSearch(s["Market/Region"].id)},{default:t(()=>[u(m(y),1)]),_:2},1032,["onClick"])):b("",!0)])]),"item.primaryUser":t(({item:{primaryUser:s}})=>[u(m(l.fullnameFor(s)),1)]),"item.secondaryUser":t(({item:{secondaryUser:s}})=>[u(m(l.fullnameFor(s)),1)]),"expanded-row":t(({item:s,columns:y})=>[h("td",{colspan:y.length},[a(B,{class:"bg-surface-bright"},{default:t(()=>[l.userCanAdministerTerritories?(d(),T(_,{key:0},{default:t(()=>[a(G,{lines:"two"},{default:t(()=>[a(P,null,{default:t(()=>e[25]||(e[25]=[h("h4",null,"Actions",-1)])),_:1,__:[25]}),h("div",null,[a(K,{location:"bottom"},{activator:t(({props:p})=>[a(v,$({class:"pa-0",color:"info",icon:"$vuetify.icons.edit",variant:"text"},p,{onClick:k=>l.openEditOn(s.id)}),null,16,["onClick"])]),default:t(()=>[e[26]||(e[26]=h("span",null,"Edit",-1))]),_:2,__:[26]},1024),s.territoryType==="F"?(d(),T(K,{key:0,location:"bottom"},{activator:t(({props:p})=>[h("span",ee(re(p)),[a(v,{class:"pa-0 ml-2",color:"error-lighten-2",disabled:!l.canBeDeleted(s),icon:"$vuetify.icons.trash",variant:"text",onClick:k=>l.onClickDelete(s)},null,8,["disabled","onClick"])],16)]),default:t(()=>[h("span",null,m(l.canBeDeleted(s)?"Delete":"Can't delete with attached sites"),1)]),_:2},1024)):b("",!0)])]),_:2},1024)]),_:2},1024)):b("",!0),s.territoryType==="F"?(d(),T(_,{key:1},{default:t(()=>[a(g,null,{default:t(()=>[a(C,{headers:i.siteHeaders,loading:i.fieldSites[s.id].isLoadingSites,"loading-text":"loading...","items-per-page":"5",items:i.fieldSites[s.id].sites,hover:"",class:"expanded-table mb-6"},{top:t(()=>e[27]||(e[27]=[h("h3",{class:"pl-1"}," Sites ",-1)])),"item.location.code":t(({item:p,value:k})=>[h("td",null,[l.userCanManageLocations?(d(),c("a",{key:0,rel:"external",target:"_blank",href:p.location.link},m(k),9,ce)):(d(),c("span",ge,m(k),1))])]),"item.placement":t(({item:p,value:k})=>[h("td",null,[l.userCanManageLocations?(d(),c("a",{key:0,rel:"external",target:"_blank",href:p.link},m(k),9,ke)):(d(),c("span",be,m(k),1))])]),"item.kiosk.serialNumber":t(({item:p,value:k})=>[h("td",null,[l.userCanViewKiosks?(d(),c("a",{key:0,rel:"external",target:"_blank",href:p.kiosk.link},m(k),9,ve)):(d(),c("span",_e,m(k),1))])]),"no-data":t(()=>[i.fieldSites[s.id].apiError?(d(),c("span",Ce,m(i.fieldSites[s.id].apiError),1)):(d(),c("span",Ve," No sites attached. "))]),_:2},1032,["headers","loading","items"])]),_:2},1024),a(z)]),_:2},1024)):(d(),T(_,{key:2},{default:t(()=>[a(g,null,{default:t(()=>[a(G,{lines:"two"},{default:t(()=>[a(P,null,{default:t(()=>[u(m(l.childTerritoryType(s))+" territories under "+m(s.name),1)]),_:2},1024),(d(!0),c(U,null,D(l.availableTerritories[s.id],p=>(d(),T(V,{key:p.name,class:"ma-2",label:"",onClick:k=>l.handleSearch(p.id,"cardChip")},{default:t(()=>[u(m(p.name),1)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024),a(z)]),_:2},1024))]),_:2},1024)],8,he)]),_:2},1032,["expanded","headers","items","loading","search","custom-filter"])]),_:1})]),_:1})]),_:1})}const Ke=Y(ue,[["render",Se],["__scopeId","data-v-f7b71f14"]]);export{Ke as default};
