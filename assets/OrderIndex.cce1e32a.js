import g from"./SearchFormActions.9b387442.js";import C from"./SearchFormFieldset.2aa0dec9.js";import O from"./SearchFormInput.b84ad1fe.js";import T from"./SearchFormRow.bc300fb2.js";import U from"./SearchForm.eb63e990.js";import k from"./OrderTable.7e5fbc9d.js";import w from"./DefaultLayout.61d229e4.js";import{m as x,a as N,b as h,c as D}from"./vuex.0eb68a2c.js";import{_ as R,w as v,x as I,e as L,c as M}from"./index.8a58b007.js";import{aA as q}from"./vuetify.65d833ec.js";import{f as y,s as Q}from"./date-fns.d38e1d55.js";import{S as s,e as f,x as c,k as m,g as a,z as E}from"./@vue.ee679632.js";import"./vue-atomic-docs.4f3653eb.js";import"./vue-router.ec64e966.js";import"./axios.eca6faa7.js";import"./axios-cache-interceptor.0956cad0.js";import"./cache-parser.124ebbb8.js";import"./fast-defer.b34f24de.js";import"./object-code.c2755e43.js";import"./@fortawesome.2cecc5e3.js";import"./@awesome.me.7dae7d79.js";import"./DatePicker.55087c86.js";import"./@vuepic.604267a2.js";import"./@babel.5574241f.js";import"./ResultsLimitMenu.e0b88f86.js";import"./UserAvatar.ff6b25f1.js";import"./ActionMenu.9b302073.js";import"./AssignOrder.d99f2a00.js";import"./StageChip.18205d71.js";import"./ProductImageKioskNumber.a237bccc.js";import"./MeruDataTable.80a372ee.js";const P={components:{SearchFormActions:g,SearchFormInput:O,SearchFormFieldset:C,SearchFormRow:T,SearchForm:U,OrderTable:k,DefaultLayout:w},setup(){const{smAndUp:t,lgAndUp:e}=q();return{smAndUp:t,lgAndUp:e}},data(){return{loading:!1,formData:{orderNumber:void 0,orderCategories:void 0,locationType:void 0,kioskNumber:void 0,name:void 0,email:void 0,last4:void 0,maxAmount:void 0,minAmount:void 0,startDate:y(Q(new Date,1),"yyyy-MM-dd"),endDate:y(new Date,"yyyy-MM-dd"),limit:200},locationTypes:[{title:"Production",value:"prod"},{title:"Factory",value:"factory"},{title:"Other",value:"other"}],stageItems:v,rules:{firstName:[t=>/^[a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð ,.'-]+$/u.test(t)||"No Special Characters Allowed"],email:I}}},computed:{...x("orders",["orders","activeSearchFormData"]),...N("orders",{orderCategoryItems:"formattedOrderCategoryItems"}),dateRange:{get(){let t=[];return this.formData.endDate&&(t=[this.formData.startDate,this.formData.endDate]),t},set(t){var e,u;this.formData.startDate=((e=t==null?void 0:t[0])==null?void 0:e.substr(0,10))||void 0,this.formData.endDate=((u=t==null?void 0:t[1])==null?void 0:u.substr(0,10))||void 0}},isValidSearch(){return!!(this.dateRange.length===2||this.formData.orderNumber)}},async mounted(){const t=Object.keys(this.$route.query).length===0;this.parseFormDataFromQuery(),await this.fetchOrderCategories(),await this.submitSearch(t)},unmounted(){this.resetCardDrawer(),this.setActiveSearchFormData({})},methods:{getOrderStageName:L,getOrderStageColor:M,...h("orders",["fetchAllOrders","fetchOrderCategories"]),...D("orders",["setActiveSearchFormData"]),...D("app",["setCardDrawer","resetCardDrawer"]),...h("order",["fetchOrderDetails"]),async submitSearch(t=!0){if(!this.isValidSearch)return;t&&this.updateSearchQuery(),this.loading=!0;const{...e}=this.formData;e.minAmount=e.minAmount||void 0,e.maxAmount=e.maxAmount||void 0,this.setActiveSearchFormData(e),await this.handleOrdersFetch(),this.loading=!1,this.$refs.orderTable.resetFilters()},async handleOrdersFetch(){try{await this.fetchAllOrders()}catch(t){this.$store.dispatch("app/setSnackbar",{message:t.message,color:"error"})}},updateSearchQuery(){let t={};Object.keys(this.formData).forEach(e=>{t[e]=this.formData[e]||void 0}),this.$router.replace({query:{...this.$route.query,...t}})},parseFormDataFromQuery(){Object.keys(this.formData).forEach(t=>{let e=this.$route.query[t];e&&(["limit"].includes(t)&&(e=parseInt(e)),["orderCategories"].includes(t)&&(e=Array.isArray(e)?e:[e]),this.formData[t]=e||void 0)})},async clearSearch(){this.$refs.orderSearchForm.resetForm(),this.formData.endDate=void 0,this.formData.startDate=void 0}}};function j(t,e,u,i,r,n){const l=s("SearchFormInput"),d=s("SearchFormFieldset"),p=s("SearchFormRow"),b=s("SearchFormActions"),V=s("SearchForm"),S=s("OrderTable"),F=s("RouterView"),A=s("DefaultLayout");return f(),c(A,{"no-content-padding":""},{default:m(()=>[a(V,{ref:"orderSearchForm","form-data":r.formData,"onUpdate:formData":e[12]||(e[12]=o=>r.formData=o)},{default:m(()=>[a(p,null,{default:m(()=>[a(d,{"col-props":{cols:12,md:2}},{default:m(()=>[a(l,{modelValue:r.formData.kioskNumber,"onUpdate:modelValue":e[0]||(e[0]=o=>r.formData.kioskNumber=o),"input-type":"VTextField",label:"Kiosk Number",density:"compact"},null,8,["modelValue"])]),_:1}),a(d,{"col-props":{cols:12,md:10}},{default:m(()=>[a(l,{modelValue:r.formData.orderNumber,"onUpdate:modelValue":e[1]||(e[1]=o=>r.formData.orderNumber=o),"input-type":"VTextField",label:"Transaction ID","col-props":{cols:6,md:3}},null,8,["modelValue"]),a(l,{ref:"dateRangePicker",modelValue:n.dateRange,"onUpdate:modelValue":e[2]||(e[2]=o=>n.dateRange=o),"input-type":"DatePicker",placeholder:"Start ~ End Date","hide-input-icon":!1,range:"","col-props":{cols:6,md:3}},null,8,["modelValue"]),t.orderCategoryItems.length?(f(),c(l,{key:0,modelValue:r.formData.orderCategories,"onUpdate:modelValue":e[3]||(e[3]=o=>r.formData.orderCategories=o),"input-type":"VSelect",label:"Order Categories",items:t.orderCategoryItems,multiple:"","col-props":{cols:6,md:3}},null,8,["modelValue","items"])):E("",!0),a(l,{modelValue:r.formData.locationType,"onUpdate:modelValue":e[4]||(e[4]=o=>r.formData.locationType=o),"input-type":"VSelect",label:"Location Type",items:r.locationTypes,"col-props":{cols:6,md:3}},null,8,["modelValue","items"])]),_:1})]),_:1}),a(p,null,{default:m(()=>[a(d,{"col-props":{cols:12}},{default:m(()=>[a(l,{modelValue:r.formData.name,"onUpdate:modelValue":e[5]||(e[5]=o=>r.formData.name=o),"input-type":"VTextField",label:"Card Holder's Name","prepend-icon":i.smAndUp?"$user":void 0,"col-props":{cols:6,md:3},rules:r.rules.firstName},null,8,["modelValue","prepend-icon","rules"]),a(l,{modelValue:r.formData.email,"onUpdate:modelValue":e[6]||(e[6]=o=>r.formData.email=o),"input-type":"VTextField",label:"Email","prepend-icon":i.smAndUp?"$envelope":void 0,"col-props":{cols:6,md:3},rules:r.rules.email},null,8,["modelValue","prepend-icon","rules"]),a(l,{modelValue:r.formData.last4,"onUpdate:modelValue":e[7]||(e[7]=o=>r.formData.last4=o),"input-type":"VTextField",label:"CC Last 4","prepend-icon":i.smAndUp?"$ccVisa":void 0,type:"number",maxlength:"4","col-props":{cols:4,md:2}},null,8,["modelValue","prepend-icon"]),a(l,{modelValue:r.formData.minAmount,"onUpdate:modelValue":e[8]||(e[8]=o=>r.formData.minAmount=o),"input-type":"VTextField",label:"Min Amount",type:"number",max:"300","prepend-icon":i.smAndUp?"$squareDollar":void 0,"col-props":{cols:4,md:2}},null,8,["modelValue","prepend-icon"]),a(l,{modelValue:r.formData.maxAmount,"onUpdate:modelValue":e[9]||(e[9]=o=>r.formData.maxAmount=o),"input-type":"VTextField",type:"number",label:"Max Amount",max:300,"col-props":{cols:4,md:2}},null,8,["modelValue"])]),_:1})]),_:1}),a(p,null,{"end-of-row":m(()=>[a(b,{disabled:!n.isValidSearch,"submit-btn-label":r.loading?"Loading":"Search","reset-btn-label":"Clear All","submit-btn-icon":"$search",onReset:n.clearSearch,onSubmit:e[11]||(e[11]=o=>n.submitSearch())},null,8,["disabled","submit-btn-label","onReset"])]),default:m(()=>[a(d,{"col-props":{cols:12}},{default:m(()=>[a(l,{modelValue:r.formData.limit,"onUpdate:modelValue":e[10]||(e[10]=o=>r.formData.limit=o),"results-count":t.orders.length,"input-type":"ResultsLimitMenu",label:"Results Limit","col-props":{cols:12}},null,8,["modelValue","results-count"])]),_:1})]),_:1})]),_:1},8,["form-data"]),a(S,{ref:"orderTable",orders:t.orders},null,8,["orders"]),(f(),c(F,{key:t.$route.fullPath}))]),_:1})}const Ve=R(P,[["render",j]]);export{Ve as default};
