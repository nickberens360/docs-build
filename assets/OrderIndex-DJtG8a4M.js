import g from"./SearchFormActions-DQrwQtps.js";import C from"./SearchFormFieldset-B0Hj3kv8.js";import O from"./SearchFormInput-dGgQLNML.js";import T from"./SearchFormRow-DzURwVUk.js";import U from"./SearchForm-Bsxklmov.js";import w from"./OrderTable-B9x55pW9.js";import k from"./DefaultLayout-DdfUBm6-.js";import{b as h,c as D,m as x,a as R}from"./vuex-D3TwipD2.js";import{_ as N,e as v,c as I,w as L,x as M}from"./index-LK9MQE2L.js";import{m as y,R as q}from"./date-fns-2ylUqVpG.js";import{aA as Q}from"./vuetify-BgnNF2O3.js";import{C as f,i as m,e as a,_ as s,s as E,A as c}from"./@vue-DNrUJgob.js";import"./@babel-BTTPuEuv.js";import"./vue-component-docs-plugin-BnqcuvvC.js";import"./vue-router-BVOKdCCq.js";import"./axios-xsH4HHeE.js";import"./axios-cache-interceptor-DgAMPFM2.js";import"./cache-parser-DXYp_BCq.js";import"./fast-defer-9MI9za_P.js";import"./object-code-SBtdq8jY.js";import"./@fortawesome-BWcQmPY7.js";import"./@awesome.me-Btqfd-fw.js";import"./DatePicker-BuTbACp2.js";import"./@vuepic-Coh5ezXU.js";import"./ResultsLimitMenu-P4cTAkLT.js";import"./UserAvatar-7P63MZM0.js";import"./ActionMenu-BnUxQ9CM.js";import"./AssignOrder-Cq3wmxtM.js";import"./StageChip-BefCQc9-.js";import"./ProductImageKioskNumber-BWLKfBOU.js";import"./MeruDataTable-jf3gvfqw.js";const P={components:{SearchFormActions:g,SearchFormInput:O,SearchFormFieldset:C,SearchFormRow:T,SearchForm:U,OrderTable:w,DefaultLayout:k},setup(){const{smAndUp:t,lgAndUp:e}=Q();return{smAndUp:t,lgAndUp:e}},data(){return{loading:!1,formData:{orderNumber:void 0,orderCategories:void 0,locationType:void 0,kioskNumber:void 0,name:void 0,email:void 0,last4:void 0,maxAmount:void 0,minAmount:void 0,startDate:y(q(new Date,1),"yyyy-MM-dd"),endDate:y(new Date,"yyyy-MM-dd"),limit:200},locationTypes:[{title:"Production",value:"prod"},{title:"Factory",value:"factory"},{title:"Other",value:"other"}],stageItems:M,rules:{firstName:[t=>/^[a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð ,.'-]+$/u.test(t)||"No Special Characters Allowed"],email:L}}},computed:{...R("orders",["orders","activeSearchFormData"]),...x("orders",{orderCategoryItems:"formattedOrderCategoryItems"}),dateRange:{get(){let t=[];return this.formData.endDate&&(t=[this.formData.startDate,this.formData.endDate]),t},set(t){var e,u;this.formData.startDate=((e=t==null?void 0:t[0])==null?void 0:e.substr(0,10))||void 0,this.formData.endDate=((u=t==null?void 0:t[1])==null?void 0:u.substr(0,10))||void 0}},isValidSearch(){return!!(this.dateRange.length===2||this.formData.orderNumber)}},async mounted(){const t=Object.keys(this.$route.query).length===0;this.parseFormDataFromQuery(),await this.fetchOrderCategories(),await this.submitSearch(t)},unmounted(){this.resetCardDrawer(),this.setActiveSearchFormData({})},methods:{getOrderStageName:I,getOrderStageColor:v,...h("orders",["fetchAllOrders","fetchOrderCategories"]),...D("orders",["setActiveSearchFormData"]),...D("app",["setCardDrawer","resetCardDrawer"]),...h("order",["fetchOrderDetails"]),async submitSearch(t=!0){if(!this.isValidSearch)return;t&&this.updateSearchQuery(),this.loading=!0;const{...e}=this.formData;e.minAmount=e.minAmount||void 0,e.maxAmount=e.maxAmount||void 0,this.setActiveSearchFormData(e),await this.handleOrdersFetch(),this.loading=!1,this.$refs.orderTable.resetFilters()},async handleOrdersFetch(){try{await this.fetchAllOrders()}catch(t){this.$store.dispatch("app/setSnackbar",{message:t.message,color:"error"})}},updateSearchQuery(){let t={};Object.keys(this.formData).forEach(e=>{t[e]=this.formData[e]||void 0}),this.$router.replace({query:{...this.$route.query,...t}})},parseFormDataFromQuery(){Object.keys(this.formData).forEach(t=>{let e=this.$route.query[t];e&&(["limit"].includes(t)&&(e=parseInt(e)),["orderCategories"].includes(t)&&(e=Array.isArray(e)?e:[e]),this.formData[t]=e||void 0)})},async clearSearch(){this.$refs.orderSearchForm.resetForm(),this.formData.endDate=void 0,this.formData.startDate=void 0}}};function _(t,e,u,i,r,n){const l=s("SearchFormInput"),d=s("SearchFormFieldset"),p=s("SearchFormRow"),b=s("SearchFormActions"),V=s("SearchForm"),F=s("OrderTable"),S=s("RouterView"),A=s("DefaultLayout");return c(),f(A,{"no-content-padding":""},{default:m(()=>[a(V,{ref:"orderSearchForm","form-data":r.formData,"onUpdate:formData":e[12]||(e[12]=o=>r.formData=o)},{default:m(()=>[a(p,null,{default:m(()=>[a(d,{"col-props":{cols:12,md:2}},{default:m(()=>[a(l,{modelValue:r.formData.kioskNumber,"onUpdate:modelValue":e[0]||(e[0]=o=>r.formData.kioskNumber=o),"input-type":"VTextField",label:"Kiosk Number",density:"compact"},null,8,["modelValue"])]),_:1}),a(d,{"col-props":{cols:12,md:10}},{default:m(()=>[a(l,{modelValue:r.formData.orderNumber,"onUpdate:modelValue":e[1]||(e[1]=o=>r.formData.orderNumber=o),"input-type":"VTextField",label:"Transaction ID","col-props":{cols:6,md:3}},null,8,["modelValue"]),a(l,{ref:"dateRangePicker",modelValue:n.dateRange,"onUpdate:modelValue":e[2]||(e[2]=o=>n.dateRange=o),"input-type":"DatePicker",placeholder:"Start ~ End Date","hide-input-icon":!1,range:"","col-props":{cols:6,md:3}},null,8,["modelValue"]),t.orderCategoryItems.length?(c(),f(l,{key:0,modelValue:r.formData.orderCategories,"onUpdate:modelValue":e[3]||(e[3]=o=>r.formData.orderCategories=o),"input-type":"VSelect",label:"Order Categories",items:t.orderCategoryItems,multiple:"","col-props":{cols:6,md:3}},null,8,["modelValue","items"])):E("",!0),a(l,{modelValue:r.formData.locationType,"onUpdate:modelValue":e[4]||(e[4]=o=>r.formData.locationType=o),"input-type":"VSelect",label:"Location Type",items:r.locationTypes,"col-props":{cols:6,md:3}},null,8,["modelValue","items"])]),_:1})]),_:1}),a(p,null,{default:m(()=>[a(d,{"col-props":{cols:12}},{default:m(()=>[a(l,{modelValue:r.formData.name,"onUpdate:modelValue":e[5]||(e[5]=o=>r.formData.name=o),"input-type":"VTextField",label:"Card Holder's Name","prepend-icon":i.smAndUp?"$user":void 0,"col-props":{cols:6,md:3},rules:r.rules.firstName},null,8,["modelValue","prepend-icon","rules"]),a(l,{modelValue:r.formData.email,"onUpdate:modelValue":e[6]||(e[6]=o=>r.formData.email=o),"input-type":"VTextField",label:"Email","prepend-icon":i.smAndUp?"$envelope":void 0,"col-props":{cols:6,md:3},rules:r.rules.email},null,8,["modelValue","prepend-icon","rules"]),a(l,{modelValue:r.formData.last4,"onUpdate:modelValue":e[7]||(e[7]=o=>r.formData.last4=o),"input-type":"VTextField",label:"CC Last 4","prepend-icon":i.smAndUp?"$ccVisa":void 0,type:"number",maxlength:"4","col-props":{cols:4,md:2}},null,8,["modelValue","prepend-icon"]),a(l,{modelValue:r.formData.minAmount,"onUpdate:modelValue":e[8]||(e[8]=o=>r.formData.minAmount=o),"input-type":"VTextField",label:"Min Amount",type:"number",max:"300","prepend-icon":i.smAndUp?"$squareDollar":void 0,"col-props":{cols:4,md:2}},null,8,["modelValue","prepend-icon"]),a(l,{modelValue:r.formData.maxAmount,"onUpdate:modelValue":e[9]||(e[9]=o=>r.formData.maxAmount=o),"input-type":"VTextField",type:"number",label:"Max Amount",max:300,"col-props":{cols:4,md:2}},null,8,["modelValue"])]),_:1})]),_:1}),a(p,null,{"end-of-row":m(()=>[a(b,{disabled:!n.isValidSearch,"submit-btn-label":r.loading?"Loading":"Search","reset-btn-label":"Clear All","submit-btn-icon":"$search",onReset:n.clearSearch,onSubmit:e[11]||(e[11]=o=>n.submitSearch())},null,8,["disabled","submit-btn-label","onReset"])]),default:m(()=>[a(d,{"col-props":{cols:12}},{default:m(()=>[a(l,{modelValue:r.formData.limit,"onUpdate:modelValue":e[10]||(e[10]=o=>r.formData.limit=o),"results-count":t.orders.length,"input-type":"ResultsLimitMenu",label:"Results Limit","col-props":{cols:12}},null,8,["modelValue","results-count"])]),_:1})]),_:1})]),_:1},8,["form-data"]),a(F,{ref:"orderTable",orders:t.orders},null,8,["orders"]),(c(),f(S,{key:t.$route.fullPath}))]),_:1})}const Ve=N(P,[["render",_]]);export{Ve as default};
