import v from"./TabbedContent-CP2vZ3mD.js";import A from"./SearchForm-Bsxklmov.js";import _ from"./ConfirmDialog-BdnzEXkJ.js";import F from"./SearchFormFieldset-B0Hj3kv8.js";import w from"./SearchFormInput-dGgQLNML.js";import R from"./SearchFormRow-DzURwVUk.js";import C from"./ShipmentsTable-ChBzwvNh.js";import T from"./DefaultLayout-DdfUBm6-.js";import{m as N}from"./vuex-D3TwipD2.js";import{_ as V}from"./index-LK9MQE2L.js";import{i as $,f as D,b as M}from"./vuetify-BgnNF2O3.js";import{C as h,i as a,e as n,f as x,g as I,_ as c,J as E,I as q,A as d,s as B}from"./@vue-DNrUJgob.js";import"./date-fns-2ylUqVpG.js";import"./@babel-BTTPuEuv.js";import"./vue-component-docs-plugin-BnqcuvvC.js";import"./vue-router-BVOKdCCq.js";import"./axios-xsH4HHeE.js";import"./axios-cache-interceptor-DgAMPFM2.js";import"./cache-parser-DXYp_BCq.js";import"./fast-defer-9MI9za_P.js";import"./object-code-SBtdq8jY.js";import"./@fortawesome-BWcQmPY7.js";import"./@awesome.me-Btqfd-fw.js";import"./DatePicker-BuTbACp2.js";import"./@vuepic-Coh5ezXU.js";import"./ResultsLimitMenu-P4cTAkLT.js";import"./MeruDataTable-jf3gvfqw.js";const L={components:{TabbedContent:v,SearchFormInput:w,SearchFormFieldset:F,SearchFormRow:R,SearchForm:A,ShipmentsTable:C,ConfirmDialog:_,DefaultLayout:T},data(){return{searchFilter:{search:""},loading:!1,activeTab:null,lastActiveTab:"partial",tabs:[{title:"Partially Received",shipmentStatus:"partial",route:{name:"shipments",query:{status:"partial"}}},{title:"In transit",shipmentStatus:"in-transit",route:{name:"shipments",query:{status:"in-transit"}}},{title:"Recently Received",shipmentStatus:"received",route:{name:"shipments",query:{status:"received"}}},{title:"All Shipments",shipmentStatus:"all",route:{name:"shipments",query:{status:"all"}}}]}},computed:{...N({allSkus:"inventory/getSKUs"}),selectedTitle(){var e;return((e=this.tabs.find(t=>t.shipmentStatus===this.activeTab))==null?void 0:e.title)||"Shipment Status"}},watch:{$route(e,t){this.lastActiveTab=t.query.status}},beforeMount(){this.loadInitialData()},methods:{unexpandAll(){(this.$refs.shipmentsTable||[]).forEach(e=>{e.unexpandAll()})},editShipmentAction(e){this.$router.push({name:"editShipment",params:{pickNumber:e.pickNumber}})},async closeShipmentAction(e){if(await this.$refs.confirm.open("Close "+e.pickNumber,"Are you sure?",{color:"error"}))try{await this.$store.dispatch("shipments/closeShipment",{pickNumber:e.pickNumber}),this.showActionResultSnackbar("close",!0,e.pickNumber)}catch{this.showActionResultSnackbar("close",!1,e.pickNumber)}},async clearShipmentAction(e){if(await this.$refs.confirm.open("Clear "+e.pickNumber,"Are you sure?",{color:"error"}))try{await this.$store.dispatch("shipments/clearShipment",{pickNumber:e.pickNumber}),this.showActionResultSnackbar("clear",!0,e.pickNumber)}catch{this.showActionResultSnackbar("clear",!1,e.pickNumber)}},async voidShipmentAction(e){if(await this.$refs.confirm.open("Void "+e.pickNumber,"Are you sure?",{color:"error"}))try{await this.$store.dispatch("shipments/voidShipment",{pickNumber:e.pickNumber}),this.showActionResultSnackbar("void",!0,e.pickNumber)}catch{this.showActionResultSnackbar("void",!1,e.pickNumber)}},remindAction({fromUser:e,pickNumber:t,shipDate:o,toUser:m}){var l,p;const r=m.person.email,i=((p=(l=m==null?void 0:m.manager)==null?void 0:l.person)==null?void 0:p.email)||"",u=`Reminder - Receive Shipment in K2 - Pick #${t}`,S=`Pick Number: ${t}
        Sent By: ${e.person.firstName} ${e.person.lastName}
        Sent Date: ${o}
      `,f=encodeURI(`mailto:${r}?cc=${i}&Subject=${u}&Body=${S}`);window.open(f,"_blank")},async loadInitialData(){this.loading=!0;try{this.$store.dispatch("inventory/loadSKUs"),this.loading=!1}catch{this.$store.dispatch("app/setSnackbar",{timeout:-1,message:"Failed to load shipments, refresh page to try again.",color:"error"})}},displayShipmentTableError(e){this.$store.dispatch("app/setSnackbar",{message:e,color:"error"})},refreshAllShipments(){(this.$refs.shipmentsTable||[]).forEach(e=>{e.loadShipments()})},showActionResultSnackbar(e,t,o){const m={void:{successMessage:`Shipment Voided: ${o}`,errorMessage:`Failed to void shipment: ${o}`},close:{successMessage:`Shipment Closed: ${o}`,errorMessage:`Failed to close shipment: ${o}`},clear:{successMessage:`Shipment Cleared: ${o}`,errorMessage:`Failed to clear shipment: ${o}`},remind:{successMessage:`Reminder sent for shipment: ${o}`,errorMessage:"Failed to send reminder for shipment: Pick Number Undefined"}};this.$store.dispatch("app/setSnackbar",{message:t?m[e].successMessage:m[e].errorMessage,color:!t&&"error"})}}};function P(e,t,o,m,r,i){const u=c("SearchFormInput"),S=c("SearchFormFieldset"),f=c("SearchFormRow"),l=c("SearchForm"),p=c("ShipmentsTable"),b=c("TabbedContent"),y=c("ConfirmDialog"),k=c("RouterView"),g=c("DefaultLayout");return d(),h(g,{"no-content-padding":""},{default:a(()=>[n(b,{tabs:r.tabs,"use-query-param":"","query-param-key":"status","item-value":"shipmentStatus","item-title":"title",onTabChange:t[2]||(t[2]=s=>r.activeTab=s)},x({"before-content":a(()=>[n(l,{"form-data":r.searchFilter,"onUpdate:formData":t[1]||(t[1]=s=>r.searchFilter=s),disabled:r.loading},{default:a(()=>[n(f,null,{"end-of-row":a(()=>[n(M,{color:"primary",class:"mx-4",variant:"elevated",disabled:r.loading,loading:r.loading,"hide-details":"",to:{name:"newShipment"}},{default:a(()=>t[3]||(t[3]=[E(" New Shipment ")])),_:1,__:[3]},8,["disabled","loading"])]),default:a(()=>[n(S,{"col-props":{cols:12,sm:6,md:4}},{default:a(()=>[n(u,{modelValue:r.searchFilter.search,"onUpdate:modelValue":t[0]||(t[0]=s=>r.searchFilter.search=s),"input-type":"VTextField",label:i.selectedTitle,"prepend-icon":"$solidSearch",dense:"",clearable:""},null,8,["modelValue","label"])]),_:1}),n($),n(D,{vertical:""})]),_:1})]),_:1},8,["form-data","disabled"])]),_:2},[I(r.tabs,s=>({name:`content.${s.shipmentStatus}`,fn:a(()=>[r.loading?B("",!0):(d(),h(p,{key:0,ref:"shipmentsTable","shipment-status":s.shipmentStatus,search:r.searchFilter.search,onEdit:i.editShipmentAction,onReceive:i.editShipmentAction,onRemind:i.remindAction,onClose:i.closeShipmentAction,onClear:i.clearShipmentAction,onVoid:i.voidShipmentAction,onError:i.displayShipmentTableError},null,8,["shipment-status","search","onEdit","onReceive","onRemind","onClose","onClear","onVoid","onError"]))])}))]),1032,["tabs"]),n(y,{ref:"confirm"},null,512),(d(),h(k,{key:e.$route.fullPath},{default:a(({Component:s})=>[(d(),h(q(s),{"back-route":r.lastActiveTab,onShipmentSaved:i.refreshAllShipments},null,40,["back-route","onShipmentSaved"]))]),_:1}))]),_:1})}const ue=V(L,[["render",P]]);export{ue as default};
