import{c as M,a as O}from"./vuex-D3TwipD2.js";import j from"./S3Image-3hbLJhu3.js";import{C as m,i as e,B as C,e as a,N as D,O as P,p as E,E as h,J as r,H as v,s as z,b as k,g as F,F as I,x as N,_ as b,A as d}from"./@vue-DNrUJgob.js";import{_ as H}from"./index-LK9MQE2L.js";import{b as Q,d as A,k as Y,l as V,m as Z,Z as J,t as W,x as L,w as y,_ as R,$ as X,a0 as G,a1 as K,r as S,D as ee,a2 as te,i as ae,a3 as le,s as oe,a4 as B,O as se}from"./vuetify-BgnNF2O3.js";import"./date-fns-2ylUqVpG.js";import"./@babel-BTTPuEuv.js";import"./vue-component-docs-plugin-BnqcuvvC.js";import"./vue-router-BVOKdCCq.js";import"./axios-xsH4HHeE.js";import"./axios-cache-interceptor-DgAMPFM2.js";import"./cache-parser-DXYp_BCq.js";import"./fast-defer-9MI9za_P.js";import"./object-code-SBtdq8jY.js";import"./@fortawesome-BWcQmPY7.js";import"./@awesome.me-Btqfd-fw.js";const $=26214400,ie={components:{S3Image:j},props:{loading:Boolean,show:Boolean,selectedCategory:{type:Object,default:()=>({})},exampleImagePrefix:{type:String,default:""}},emits:["upload"],data:()=>({queuedFiles:[],previewURLs:[],dragOver:!1,previewLoading:!1,previewPercent:0,oversizedUpload:!1}),computed:{...O("app",["uploadModal"]),livePreviewPercent(){return this.previewPercent}},methods:{...M("app",["setUploadModal"]),onUpload(){this.$emit("upload",{files:this.queuedFiles,blobs:this.previewURLs}),this.closeUploadProcess()},onFilesChosen(l){l.length&&(this.previewPercent=0,this.previewLoading=!0,this.downscaleQueuedImages(l).then(t=>{this.previewURLs=t.map(s=>URL.createObjectURL(s)),this.queuedFiles=Array.from(t),this.previewLoading=!1,this.$refs.upload.value=null}).catch(t=>{switch(this.previewLoading=!1,t){case"oversize":this.$refs.upload.value=null;break}}))},downscaleQueuedImages(l){return new Promise((t,s)=>{let g=[],i=0;const w=u=>{g.push(u),i+=u.size,this.previewPercent=g.length*170/l.length,g.length===l.length&&(this.oversizedUpload=i>$,this.oversizedUpload?(console.warn(`Total file size not within payload limit: ${i}/${$}`),s("oversize")):console.log("files compressed, within payload size limits"),t(g))};for(const u of l){const f=new FileReader;f.onerror=c=>console.error(c),f.onload=c=>{const o=new Image;o.onload=()=>{if(o.width>=1080||o.height>=1080){let n,p;o.width>=o.height?(n=1080,p=o.height*n/o.width):(p=1080,n=o.width*p/o.height);const U=document.createElement("canvas");U.width=n,U.height=p;const _=U.getContext("2d");_.drawImage(o,0,0,n,p),_.canvas.toBlob(T=>{const q=new File([T],u.name,{type:u.type});w(q)},u.type,1)}else w(u)},o.src=c.target.result},f.readAsDataURL(u)}})},chooseFile(){this.setUploadModal(!0)},closeUploadProcess(){this.setUploadModal(!1),this.queuedFiles=[],this.previewURLs=[],this.oversizedUpload=!1},openSystemDialog(){this.$refs.upload.click()}}},ne={class:"font-weight-bold text-primary subtitle text-center"},re={key:0},de={key:1};function ue(l,t,s,x,g,i){const w=b("S3Image"),u=b("VBtnSecondary"),f=b("VBtnPrimary");return d(),m(oe,{location:"start"},{activator:e(({props:c})=>[a(le,null,{default:e(()=>[D(a(Q,E({loading:s.loading,color:"secondary"},c,{icon:"",position:"fixed",size:"large",style:l.$vuetify.display.smAndDown?"bottom: 80px":"",location:"bottom end",onClick:h(i.chooseFile,["stop"])}),{default:e(()=>[a(A,null,{default:e(()=>t[6]||(t[6]=[r("$vuetify.icons.camera")])),_:1,__:[6]}),a(Y,{modelValue:l.uploadModal,"onUpdate:modelValue":t[4]||(t[4]=o=>l.uploadModal=o),"max-width":800,fullscreen:l.$vuetify.display.smAndDown,"onClick:outside":i.closeUploadProcess},{default:e(()=>[a(V,null,{default:e(()=>[a(Z,null,{default:e(()=>[r("Upload "+v(s.selectedCategory.name)+" Image",1)]),_:1}),a(J,{class:"mt-1 text-subtitle-2"},{default:e(()=>[r(v(s.selectedCategory.desc),1)]),_:1}),a(W,{class:"pb-0"},{default:e(()=>[a(L,{align:"stretch"},{default:e(()=>[a(y,{cols:"12",sm:"6"},{default:e(()=>[a(V,{flat:""},{default:e(()=>[a(R,{cycle:"",interval:"5000","show-arrows":s.selectedCategory.qty>1,"hide-delimiters":"",height:"100%","next-icon":"$vuetify.icons.angleRight","prev-icon":"$vuetify.icons.angleLeft"},{default:e(()=>[(d(!0),k(I,null,F(s.selectedCategory.qty,o=>(d(),m(B,{key:o},{default:e(()=>[a(w,{bucket:"minutekey-kiosk-images","object-key":`samples/${s.selectedCategory.code}${o}.jpg`,"lazy-key":"samples/loadingimage.png","aspect-ratio":l.$vuetify.display.smAndDown?void 0:3/4},null,8,["object-key","aspect-ratio"])]),_:2},1024))),128))]),_:1},8,["show-arrows"])]),_:1})]),_:1}),a(y,{cols:"12",sm:"6"},{default:e(()=>[a(X,null,{default:e(({hover:o})=>[a(G,{"aspect-ratio":l.$vuetify.display.smAndDown?4/3:3/4},{default:e(()=>[a(V,{ripple:l.previewURLs.length===0,link:"",flat:"",class:N(`droppable-area bg-primary-lighten-${o||l.dragOver?4:5}`),onDrop:t[1]||(t[1]=h(n=>i.onFilesChosen(n.dataTransfer.files),["prevent"])),onDragleave:t[2]||(t[2]=h(n=>l.dragOver=!1,["prevent"])),onDragover:t[3]||(t[3]=h(n=>l.dragOver=!0,["prevent"])),onClick:i.openSystemDialog},{default:e(()=>[l.previewLoading?(d(),m(K,{key:0,height:25,absolute:"",location:"top",color:"secondary","model-value":i.livePreviewPercent},null,8,["model-value"])):z("",!0),l.previewURLs.length?(d(),m(V,{key:1,flat:"",height:"100%"},{default:e(()=>[a(R,{"show-arrows":l.queuedFiles.length>1,"hide-delimiters":"",height:"100%","next-icon":"$vuetify.icons.angleRight","prev-icon":"$vuetify.icons.angleLeft",onClick:t[0]||(t[0]=h(()=>{},["stop"]))},{default:e(()=>[(d(!0),k(I,null,F(l.previewURLs,(n,p)=>(d(),m(B,{key:p},{default:e(()=>[a(se,{"aspect-ratio":l.$vuetify.display.smAndDown?void 0:3/4,src:n},null,8,["aspect-ratio","src"])]),_:2},1024))),128))]),_:1},8,["show-arrows"])]),_:1})):(d(),m(L,{key:2,align:"center",class:"fill-height"},{default:e(()=>[a(y,null,{default:e(()=>[C("div",ne,[a(A,{class:"mx-auto mb-4",size:"x-large"},{default:e(()=>t[7]||(t[7]=[r(" $vuetify.icons.image ")])),_:1,__:[7]}),l.$vuetify.display.smAndDown?(d(),k("div",re," Tap to Upload ")):(d(),k("div",de,t[8]||(t[8]=[r(" Drop your image here "),C("br",null,null,-1),r(" or click to upload ")])))])]),_:1})]),_:1}))]),_:2},1032,["ripple","class","onClick"])]),_:2},1032,["aspect-ratio"])]),_:1})]),_:1})]),_:1}),l.$vuetify.display.smAndDown?z("",!0):(d(),m(L,{key:0,class:"font-weight-bold text-center"},{default:e(()=>[a(y,{cols:"6"},{default:e(()=>[r(" Example "+v(s.selectedCategory.name)+" Image"+v(s.selectedCategory.qty>1?"s":""),1)]),_:1}),a(y,{cols:"6"},{default:e(()=>[r(" Your Image"+v(l.queuedFiles.length>1?"s":""),1)]),_:1})]),_:1}))]),_:1}),a(S,null,{default:e(()=>[a(ee,null,{default:e(()=>[D(a(te,{icon:"$vuetify.icons.exclamationTriangle",class:"mx-4 mb-0",variant:"outlined",width:"100%",type:"error"},{default:e(()=>t[9]||(t[9]=[r(" Total file size is too large. Please try again with less images. ")])),_:1,__:[9]},512),[[P,l.oversizedUpload]])]),_:1})]),_:1}),a(S,null,{default:e(()=>[a(ae),a(u,{onClick:i.closeUploadProcess},{default:e(()=>t[10]||(t[10]=[r(" Cancel ")])),_:1,__:[10]},8,["onClick"]),a(f,{class:"mr-4",disabled:!l.queuedFiles.length||l.oversizedUpload,onClick:i.onUpload},{default:e(()=>t[11]||(t[11]=[r(" Upload ")])),_:1,__:[11]},8,["disabled","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","fullscreen","onClick:outside"])]),_:2},1040,["loading","style","onClick"]),[[P,s.show]])]),_:2},1024),C("input",{ref:"upload",class:"hidden",accept:".jpg,.jpg,.png",type:"file",multiple:"",onChange:t[5]||(t[5]=o=>i.onFilesChosen(o.target.files))},null,544)]),default:e(()=>[t[12]||(t[12]=C("span",null,"Add Photo",-1))]),_:1,__:[12]})}const De=H(ie,[["render",ue],["__scopeId","data-v-7ae0eff6"]]);export{De as default};
