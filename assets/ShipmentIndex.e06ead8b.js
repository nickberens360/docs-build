import v from"./TabbedContent.b80805b8.js";import A from"./SearchForm.eb63e990.js";import _ from"./ConfirmDialog.060a100c.js";import F from"./SearchFormFieldset.2aa0dec9.js";import w from"./SearchFormInput.b84ad1fe.js";import R from"./SearchFormRow.bc300fb2.js";import T from"./ShipmentsTable.c829d4d6.js";import C from"./DefaultLayout.61d229e4.js";import{a as N}from"./vuex.0eb68a2c.js";import{_ as V}from"./index.8a58b007.js";import{d as $,i as D,f as M}from"./vuetify.65d833ec.js";import{S as a,e as h,x as d,k as n,g as c,i as x,j as E,J as I,y as q,z as B}from"./@vue.ee679632.js";import"./date-fns.d38e1d55.js";import"./vue-atomic-docs.4f3653eb.js";import"./vue-router.ec64e966.js";import"./axios.eca6faa7.js";import"./axios-cache-interceptor.0956cad0.js";import"./cache-parser.124ebbb8.js";import"./fast-defer.b34f24de.js";import"./object-code.c2755e43.js";import"./@fortawesome.2cecc5e3.js";import"./@awesome.me.7dae7d79.js";import"./DatePicker.55087c86.js";import"./@vuepic.604267a2.js";import"./@babel.5574241f.js";import"./ResultsLimitMenu.e0b88f86.js";import"./MeruDataTable.80a372ee.js";const L={components:{TabbedContent:v,SearchFormInput:w,SearchFormFieldset:F,SearchFormRow:R,SearchForm:A,ShipmentsTable:T,ConfirmDialog:_,DefaultLayout:C},data(){return{searchFilter:{search:""},loading:!1,activeTab:null,lastActiveTab:"partial",tabs:[{title:"Partially Received",shipmentStatus:"partial",route:{name:"shipments",query:{status:"partial"}}},{title:"In transit",shipmentStatus:"in-transit",route:{name:"shipments",query:{status:"in-transit"}}},{title:"Recently Received",shipmentStatus:"received",route:{name:"shipments",query:{status:"received"}}},{title:"All Shipments",shipmentStatus:"all",route:{name:"shipments",query:{status:"all"}}}]}},computed:{...N({allSkus:"inventory/getSKUs"}),selectedTitle(){var e;return((e=this.tabs.find(t=>t.shipmentStatus===this.activeTab))==null?void 0:e.title)||"Shipment Status"}},watch:{$route(e,t){this.lastActiveTab=t.query.status}},beforeMount(){this.loadInitialData()},methods:{unexpandAll(){(this.$refs.shipmentsTable||[]).forEach(e=>{e.unexpandAll()})},editShipmentAction(e){this.$router.push({name:"editShipment",params:{pickNumber:e.pickNumber}})},async closeShipmentAction(e){if(await this.$refs.confirm.open("Close "+e.pickNumber,"Are you sure?",{color:"error"}))try{await this.$store.dispatch("shipments/closeShipment",{pickNumber:e.pickNumber}),this.showActionResultSnackbar("close",!0,e.pickNumber)}catch{this.showActionResultSnackbar("close",!1,e.pickNumber)}},async clearShipmentAction(e){if(await this.$refs.confirm.open("Clear "+e.pickNumber,"Are you sure?",{color:"error"}))try{await this.$store.dispatch("shipments/clearShipment",{pickNumber:e.pickNumber}),this.showActionResultSnackbar("clear",!0,e.pickNumber)}catch{this.showActionResultSnackbar("clear",!1,e.pickNumber)}},async voidShipmentAction(e){if(await this.$refs.confirm.open("Void "+e.pickNumber,"Are you sure?",{color:"error"}))try{await this.$store.dispatch("shipments/voidShipment",{pickNumber:e.pickNumber}),this.showActionResultSnackbar("void",!0,e.pickNumber)}catch{this.showActionResultSnackbar("void",!1,e.pickNumber)}},remindAction({fromUser:e,pickNumber:t,shipDate:o,toUser:m}){var l,p;const r=m.person.email,i=((p=(l=m==null?void 0:m.manager)==null?void 0:l.person)==null?void 0:p.email)||"",u=`Reminder - Receive Shipment in K2 - Pick #${t}`,S=`Pick Number: ${t}
        Sent By: ${e.person.firstName} ${e.person.lastName}
        Sent Date: ${o}
      `,f=encodeURI(`mailto:${r}?cc=${i}&Subject=${u}&Body=${S}`);window.open(f,"_blank")},async loadInitialData(){this.loading=!0;try{this.$store.dispatch("inventory/loadSKUs"),this.loading=!1}catch{this.$store.dispatch("app/setSnackbar",{timeout:-1,message:"Failed to load shipments, refresh page to try again.",color:"error"})}},displayShipmentTableError(e){this.$store.dispatch("app/setSnackbar",{message:e,color:"error"})},refreshAllShipments(){(this.$refs.shipmentsTable||[]).forEach(e=>{e.loadShipments()})},showActionResultSnackbar(e,t,o){const m={void:{successMessage:`Shipment Voided: ${o}`,errorMessage:`Failed to void shipment: ${o}`},close:{successMessage:`Shipment Closed: ${o}`,errorMessage:`Failed to close shipment: ${o}`},clear:{successMessage:`Shipment Cleared: ${o}`,errorMessage:`Failed to clear shipment: ${o}`},remind:{successMessage:`Reminder sent for shipment: ${o}`,errorMessage:"Failed to send reminder for shipment: Pick Number Undefined"}};this.$store.dispatch("app/setSnackbar",{message:t?m[e].successMessage:m[e].errorMessage,color:!t&&"error"})}}};function P(e,t,o,m,r,i){const u=a("SearchFormInput"),S=a("SearchFormFieldset"),f=a("SearchFormRow"),l=a("SearchForm"),p=a("ShipmentsTable"),b=a("TabbedContent"),y=a("ConfirmDialog"),k=a("RouterView"),g=a("DefaultLayout");return h(),d(g,{"no-content-padding":""},{default:n(()=>[c(b,{tabs:r.tabs,"use-query-param":"","query-param-key":"status","item-value":"shipmentStatus","item-title":"title",onTabChange:t[2]||(t[2]=s=>r.activeTab=s)},x({"before-content":n(()=>[c(l,{"form-data":r.searchFilter,"onUpdate:formData":t[1]||(t[1]=s=>r.searchFilter=s),disabled:r.loading},{default:n(()=>[c(f,null,{"end-of-row":n(()=>[c($,{color:"primary",class:"mx-4",variant:"elevated",disabled:r.loading,loading:r.loading,"hide-details":"",to:{name:"newShipment"}},{default:n(()=>[I(" New Shipment ")]),_:1},8,["disabled","loading"])]),default:n(()=>[c(S,{"col-props":{cols:12,sm:6,md:4}},{default:n(()=>[c(u,{modelValue:r.searchFilter.search,"onUpdate:modelValue":t[0]||(t[0]=s=>r.searchFilter.search=s),"input-type":"VTextField",label:i.selectedTitle,"prepend-icon":"$solidSearch",dense:"",clearable:""},null,8,["modelValue","label"])]),_:1}),c(D),c(M,{vertical:""})]),_:1})]),_:1},8,["form-data","disabled"])]),_:2},[E(r.tabs,s=>({name:`content.${s.shipmentStatus}`,fn:n(()=>[r.loading?B("",!0):(h(),d(p,{key:0,ref:"shipmentsTable","shipment-status":s.shipmentStatus,search:r.searchFilter.search,onEdit:i.editShipmentAction,onReceive:i.editShipmentAction,onRemind:i.remindAction,onClose:i.closeShipmentAction,onClear:i.clearShipmentAction,onVoid:i.voidShipmentAction,onError:i.displayShipmentTableError},null,8,["shipment-status","search","onEdit","onReceive","onRemind","onClose","onClear","onVoid","onError"]))])}))]),1032,["tabs"]),c(y,{ref:"confirm"},null,512),(h(),d(k,{key:e.$route.fullPath},{default:n(({Component:s})=>[(h(),d(q(s),{"back-route":r.lastActiveTab,onShipmentSaved:i.refreshAllShipments},null,40,["back-route","onShipmentSaved"]))]),_:1}))]),_:1})}const ue=V(L,[["render",P]]);export{ue as default};
